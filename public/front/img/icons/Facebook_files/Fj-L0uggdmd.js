if (self.CavalryLogger) { CavalryLogger.start_js(["4D0Tq"]); }

__d("Shaka",["Promise"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();var h=c('Promise'),i={};(function(j){var k,l=this;function m(km,lm){var mm=km.split("."),nm=l;mm[0] in nm||!nm.execScript||nm.execScript("var "+mm[0]);for(var om;mm.length&&(om=mm.shift());)mm.length||void 0===lm?nm[om]?nm=nm[om]:nm=nm[om]={}:nm[om]=lm;}function n(km,lm){function mm(){}mm.prototype=lm.prototype;km.ic=lm.prototype;km.prototype=new mm();km.prototype.constructor=km;km.gc=function(nm,om,pm){return lm.prototype[om].apply(nm,Array.prototype.slice.call(arguments,2));};}function o(){}function p(km){var lm=console[km];lm?lm.bind||(console[km]=function(){lm.apply(console,arguments);}):console[km]=function(){};}p("error");p("warn");p("info");p("log");p("debug");function q(km){u[km]={ha:t(),end:NaN};}function r(km){if(km=u[km])km.end=t();}function s(km){return (km=u[km])&&km.end?km.end-km.ha:NaN;}var t=j.performance&&j.performance.now?j.performance.now.bind(j.performance):Date.now,u={};function v(km,lm,mm,nm){this.id=km;this.bandwidth=lm||0;this.lang=mm||"unknown";this.streamInfoID=nm;this.active=false;}m("shaka.player.AudioTrack.compare",function(km,lm){return km.lang<lm.lang?-1:km.lang>lm.lang?1:km.bandwidth<lm.bandwidth?-1:km.bandwidth>lm.bandwidth?1:0;});function w(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null;}w.prototype.clone=function(){var km=new w();km.maxHeight=this.maxHeight;km.minHeight=this.minHeight;km.maxWidth=this.maxWidth;km.maxBandwidth=this.maxBandwidth;km.minBandwidth=this.minBandwidth;return km;};function x(){this.fontSize="100%";this.fontColor=aa;this.fontOpacity=ca;this.backgroundColor=ba;this.backgroundOpacity=ca;this.fontEdge=da;}m("shaka.player.TextStyle",x);function y(km){var lm=[];lm.push("font-size: "+km.fontSize);lm.push("color: "+z(km.fontColor,km.fontOpacity));lm.push("background-color: "+z(km.backgroundColor,km.backgroundOpacity));for(var mm=[],nm=0;nm<km.fontEdge.length;++nm){var om=km.fontEdge[nm].slice(3,6);mm.push(z(km.fontEdge[nm].slice(0,3),km.fontOpacity)+" "+om.join("px ")+"px");}lm.push("text-shadow: "+mm.join(","));return lm.join("; ");}function z(km,lm){return "rgba("+km.concat(lm).join(",")+")";}var aa=[255,255,255],ba=[0,0,0];x.StandardColors={WHITE:aa,BLACK:ba,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var ca=1;x.StandardOpacities={OPAQUE:ca,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var da=[];x.EdgeStyles={NONE:da,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function ea(km,lm){this.id=km;this.lang=lm||"unknown";this.enabled=this.active=false;}m("shaka.player.TextTrack.compare",function(km,lm){return km.lang<lm.lang?-1:km.lang>lm.lang?1:0;});function fa(km,lm,mm,nm,om,pm,qm){this.id=km;this.bandwidth=lm||0;this.width=mm||0;this.height=nm||0;this.streamInfoID=om;this.fbQualityLabel=pm;this.fbQualityClass=qm;this.active=false;}function ga(km,lm){var mm=km.width*km.height,nm=lm.width*lm.height;return mm<nm?-1:mm>nm?1:km.bandwidth<lm.bandwidth?-1:km.bandwidth>lm.bandwidth?1:0;}m("shaka.player.VideoTrack.compare",ga);function ha(){var km="CustomEvent" in j;if(km)try{new CustomEvent("");}catch(lm){km=false;}km||(j.CustomEvent=ia);}m("shaka.polyfill.CustomEvent.install",ha);function ia(km,lm){var mm=document.createEvent("CustomEvent"),nm=lm||{bubbles:false,cancelable:false,detail:null};mm.initCustomEvent(km,!!nm.bubbles,!!nm.cancelable,nm.detail);return mm;}function ja(){var km=Element.prototype;km.requestFullscreen=km.requestFullscreen||km.mozRequestFullScreen||km.msRequestFullscreen||km.webkitRequestFullscreen;km=Document.prototype;km.exitFullscreen=km.exitFullscreen||km.mozCancelFullScreen||km.msExitFullscreen||km.webkitExitFullscreen;"fullscreenElement" in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement;}});document.addEventListener("webkitfullscreenchange",ka);document.addEventListener("webkitfullscreenerror",ka);document.addEventListener("mozfullscreenchange",ka);document.addEventListener("mozfullscreenerror",ka);document.addEventListener("MSFullscreenChange",ka);document.addEventListener("MSFullscreenError",ka);}m("shaka.polyfill.Fullscreen.install",ja);function ka(km){var lm=km.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),lm=new Event(lm,km);km.target.dispatchEvent(lm);}function la(){return h.reject(Error("The key system specified is not supported."));}function ma(km){return null==km?h.resolve():h.reject(Error("MediaKeys not supported."));}function na(){throw new TypeError("Illegal constructor.");}na.prototype.createSession=function(){};na.prototype.setServerCertificate=function(){};function oa(){throw new TypeError("Illegal constructor.");}oa.prototype.getConfiguration=function(){};oa.prototype.createMediaKeys=function(){};function pa(km){this.c=[];this.b=[];this.ca=qa;if(km)try{km(this.aa.bind(this),this.a.bind(this));}catch(lm){this.a(lm);}}var qa=0;function ra(){j.Promise||(j.Promise=pa,j.Promise.resolve=sa,j.Promise.reject=ta,j.Promise.all=ua,j.Promise.race=va,j.setImmediate?(ya=function(km){return j.setImmediate(km);},za=function(km){return j.clearImmediate(km);}):(ya=function(km){return j.setTimeout(km,0);},za=function(km){return j.clearTimeout(km);}));}m("shaka.polyfill.Promise.install",ra);function sa(km){var lm=new pa();lm.aa(km);return lm;}function ta(km){var lm=new pa();lm.a(km);return lm;}function ua(km){function lm(rm,sm,tm){rm.ca==qa&&(om[sm]=tm,nm++,nm==om.length&&rm.aa(om));}var mm=new pa();if(!km.length)return mm.aa([]),mm;for(var nm=0,om=Array(km.length),pm=mm.a.bind(mm),qm=0;qm<km.length;++qm)km[qm]&&km[qm].then?km[qm].then(lm.bind(null,mm,qm),pm):lm(mm,qm,km[qm]);return mm;}function va(km){for(var lm=new pa(),mm=lm.aa.bind(lm),nm=lm.a.bind(lm),om=0;om<km.length;++om)km[om]&&km[om].then?km[om].then(mm,nm):mm(km[om]);return lm;}pa.prototype.then=function(km,lm){var mm=new pa();switch(this.ca){case 1:wa(this,mm,km);break;case 2:wa(this,mm,lm);break;case qa:this.c.push({Pa:mm,Ha:km}),this.b.push({Pa:mm,Ha:lm});}return mm;};pa.prototype.then=pa.prototype.then;pa.prototype.catch=function(km){return this.then(void 0,km);};pa.prototype["catch"]=pa.prototype.catch;pa.prototype.aa=function(km){if(this.ca==qa){this.Ca=km;this.ca=1;for(km=0;km<this.c.length;++km)wa(this,this.c[km].Pa,this.c[km].Ha);this.c=[];this.b=[];}};pa.prototype.a=function(km){if(this.ca==qa){this.Ca=km;this.ca=2;for(km=0;km<this.b.length;++km)wa(this,this.b[km].Pa,this.b[km].Ha);this.c=[];this.b=[];}};function wa(km,lm,mm){bb.push(function(){if(mm&&"function"==typeof mm){try{var om=mm(this.Ca);}catch(nm){lm.a(nm);return;}om instanceof pa?om==lm?lm.a(new TypeError("Chaining cycle detected")):om.then(lm.aa.bind(lm),lm.a.bind(lm)):lm.aa(om);}else 1==this.ca?lm.aa(this.Ca):lm.a(this.Ca);}.bind(km));null==ab&&(ab=ya(xa));}function xa(){for(;bb.length;){null!=ab&&(za(ab),ab=null);var km=bb;bb=[];for(var lm=0;lm<km.length;++lm)km[lm]();}}function ya(){return 0;}function za(){}var ab=null,bb=[];function cb(){var km=HTMLVideoElement.prototype;!km.getVideoPlaybackQuality&&"webkitDroppedFrameCount" in km&&(km.getVideoPlaybackQuality=db);}m("shaka.polyfill.VideoPlaybackQuality.install",cb);function db(){return {droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0};}function eb(km,lm){for(var mm=[],nm=0;nm<km.length;++nm){for(var om=false,pm=0;pm<mm.length&&!(om=lm?lm(km[nm],mm[pm]):km[nm]===mm[pm]);++pm);om||mm.push(km[nm]);}return mm;}function fb(){return Date.now()+gb;}var gb=0;function hb(km){this.b=km;this.c=0==ib;this.a=0;}var ib=1;function jb(km){return km.a<km.b.byteLength;}function kb(km){var lm=km.b.getUint8(km.a);km.a+=1;return lm;}function lb(km){var lm=km.b.getUint32(km.a,km.c);km.a+=4;return lm;}function mb(km){var lm,mm;km.c?(lm=km.b.getUint32(km.a,true),mm=km.b.getUint32(km.a+4,true)):(mm=km.b.getUint32(km.a,false),lm=km.b.getUint32(km.a+4,false));if(2097151<mm)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");km.a+=8;return mm*Math.pow(2,32)+lm;}function nb(km){if(km.a+16>km.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var lm=new Uint8Array(km.b.buffer,km.a,16);km.a+=16;return lm;}function ob(km,lm){if(km.a+lm>km.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");km.a+=lm;}function pb(km){this.b=km;this.a=new hb(km);qb||(qb=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]);}var qb;function rb(km){var lm;lm=sb(km);if(7<lm.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var mm=0,nm=0;nm<lm.length;nm++)mm=256*mm+lm[nm];lm=mm;mm=sb(km);km:{for(nm=0;nm<qb.length;nm++)if(xd(mm,qb[nm])){nm=true;break km;}nm=false;};if(nm){mm=km.b.byteLength-km.a.a;}else{if(8==mm.length&&mm[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var nm=mm[0]&(1<<8-mm.length)-1,om=1;om<mm.length;om++)nm=256*nm+mm[om];mm=nm;}mm=km.a.a+mm<=km.b.byteLength?mm:km.b.byteLength-km.a.a;nm=new DataView(km.b.buffer,km.b.byteOffset+km.a.a,mm);ob(km.a,mm);return new tb(lm,nm);}function sb(km){var lm=kb(km.a),mm;for(mm=1;8>=mm&&!(lm&1<<8-mm);mm++);if(8<mm)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var nm=new Uint8Array(mm);nm[0]=lm;for(lm=1;lm<mm;lm++)nm[lm]=kb(km.a);return nm;}function tb(km,lm){this.id=km;this.a=lm;}function ub(km){if(8<km.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==km.a.byteLength&&km.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var lm=0,mm=0;mm<km.a.byteLength;mm++)var nm=km.a.getUint8(mm),lm=256*lm+nm;return lm;}var vb={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function wb(km){this.c=Math.exp(Math.log(.5)/km);this.a=this.b=0;}wb.prototype.sample=function(km,lm){var mm=Math.pow(this.c,km);this.b=lm*(1-mm)+mm*this.b;this.a+=km;};function xb(km){return km.b/(1-Math.pow(km.c,km.a));}function yb(km){var lm=new CustomEvent(km.type,{detail:km.detail,bubbles:!!km.bubbles}),mm;for(mm in km)mm in lm||(lm[mm]=km[mm]);return lm;}function zb(km){return new CustomEvent("error",{detail:km,bubbles:true});}function ac(km,lm,mm){dc(lm);dc(mm);return mm==lm||km>=bc&&mm==lm.split("-")[0]||km>=cc&&mm.split("-")[0]==lm.split("-")[0]?true:false;}var bc=1,cc=2;function dc(km){km=km.toLowerCase().split("-");var lm=ec[km[0]];lm&&(km[0]=lm);return km.join("-");}var ec={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function fc(km){return Object.keys(km).map(function(lm){return km[lm];});}function gc(km,lm){return jc(km,lm,"boolean");}function hc(km,lm,mm){km=jc(km,lm,"number");if(null==km)return null;if(isNaN(km)||km==Number.NEGATIVE_INFINITY||km==Number.POSITIVE_INFINITY)throw new RangeError("'"+lm+"' must be finite.");if(null!=mm&&km<mm)throw new RangeError("'"+lm+"' must be >= "+mm);return km;}function ic(km,lm){return jc(km,lm,"string");}function jc(km,lm,mm){km=km[lm];if(null==km)return null;if(typeof km!=mm)throw new TypeError("'"+lm+"' must be a "+mm+".");return km;}function kc(km,lm,mm){km=km[lm];if(null==km)return null;if(!(km instanceof mm))throw new TypeError("'"+lm+"' must be an instance of "+mm.name+".");return km;}function lc(){this.a={};}lc.prototype.push=function(km,lm){this.a.hasOwnProperty(km)?this.a[km].push(lm):this.a[km]=[lm];};lc.prototype.set=function(km,lm){this.a[km]=lm;};lc.prototype.get=function(km){return (km=this.a[km])?km.slice():null;};function mc(km){var lm=[],mm;for(mm in km.a)lm.push.apply(lm,km.a[mm]);return lm;}function nc(km,lm,mm){if(km=km.a[lm])for(lm=0;lm<km.length;++lm)km[lm]==mm&&(km.splice(lm,1),--lm);}function oc(km){var lm=[],mm;for(mm in km.a)lm.push(mm);return lm;}function pc(){this.a=new lc();}pc.prototype.destroy=function(){rc(this);this.a=null;};function qc(km,lm,mm,nm){lm=new sc(lm,mm,nm);km.a.push(mm,lm);}pc.prototype.xa=function(km,lm){for(var mm=this.a.get(lm)||[],nm=0;nm<mm.length;++nm){var om=mm[nm];om.target==km&&(om.xa(),nc(this.a,lm,om));}};function rc(km){for(var lm=mc(km.a),mm=0;mm<lm.length;++mm)lm[mm].xa();km.a.a={};}function sc(km,lm,mm){this.target=km;this.type=lm;this.a=mm;this.target.addEventListener(lm,mm,false);}sc.prototype.xa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,false),this.a=this.target=null);};function tc(km){this.Ea=new lc();this.U=km;}m("shaka.util.FakeEventTarget",tc);k=tc.prototype;k.addEventListener=function(km,lm,mm){mm||this.Ea.push(km,lm);};k.removeEventListener=function(km,lm,mm){mm||nc(this.Ea,km,lm);};k.dispatchEvent=function(km){km.hasOwnProperty("srcElement")||(delete km.srcElement,Object.defineProperty(km,"srcElement",{get:function(){return null;}}));if(km.hasOwnProperty("target")){km.target=this;}else{delete km.target;var lm=this;Object.defineProperty(km,"target",{get:function(){return lm;},set:function(nm){lm=nm;}});}if(km.hasOwnProperty("currentTarget")){km.currentTarget=null;}else{delete km.currentTarget;var mm=null;Object.defineProperty(km,"currentTarget",{get:function(){return mm;},set:function(nm){mm=nm;}});}return uc(this,km);};k.Wa=false;k.ia=function(km,lm){return this.dispatchEvent(yb({type:"debug/shakaEvent",bubbles:true,detail:{type:km,event:lm}}));};function uc(km,lm){lm.currentTarget=km;for(var mm=km.Ea.get(lm.type)||[],nm=0;nm<mm.length;++nm){var om=mm[nm];try{om.handleEvent?om.handleEvent(lm):om.call(km,lm);}catch(pm){}}km.U&&lm.bubbles&&uc(km.U,lm);return lm.defaultPrevented;}function vc(km){tc.call(this,null);this.a=new wb(3);this.g=new wb(10);this.h=km||500000;this.f=0;}n(vc,tc);m("shaka.util.EWMABandwidthEstimator",vc);vc.prototype.sample=function(km,lm){if(!(65536>lm)){km=Math.max(km,50);var mm=8000*lm/km,nm=km/1000;this.a.sample(nm,mm);this.g.sample(nm,mm);this.dispatchEvent(yb({type:"bandwidth"}));this.f=Date.now();}};vc.prototype.getBandwidth=function(){return .5>this.a.a?this.h:Math.min(xb(this.a),xb(this.g));};vc.prototype.getDataAge=function(){return (Date.now()-this.f)/1000;};vc.prototype.supportsCaching=function(){return false;};function wc(km,lm,mm){vc.call(this,mm);this.c=km||0;this.b=void 0===lm?Infinity:lm;}n(wc,vc);m("shaka.util.EWMACacheBandwidthEstimator",wc);wc.prototype.sample=function(km,lm){km<=this.c&&8000*lm/km>this.b||vc.prototype.sample.call(this,km,lm);};wc.prototype.supportsCaching=function(){return Infinity!==this.b&&!!this.c;};function xc(){vc.call(this);}n(xc,vc);m("shaka.util.EWMASignedURLBandwidthEstimator",xc);xc.prototype.supportsCaching=function(){return true;};function yc(){var km,lm,mm=new h(function(nm,om){km=nm;lm=om;});mm.resolve=km;mm.reject=lm;mm.destroy=yc.prototype.destroy;return mm;}yc.prototype.destroy=function(){this.catch(function(){});var km=Error("Destroyed!");km.type="destroy";this.reject(km);};function zc(km){km.split("").reduce(function(lm,mm,nm){return lm+(nm&&0==nm%4?" "+mm:mm);});}function ad(){this.Ba=new yc();this.c=false;this.Z=null;this.a=[];this.b=null;}function bd(km,lm){if(km.c)throw Error("Cannot append to a running task!");km.a.push(lm);}ad.prototype.start=function(){if(this.c)throw Error("Task already started!");this.c=true;this.a.unshift(function(){});cd(this,void 0);};ad.prototype.end=function(){this.a.splice(1);};function cd(km,lm){var mm=km.a[0](lm),nm;mm?(nm=mm[0],km.b=mm[1]):(nm=h.resolve(),km.b=null);nm.then(ed(km,function(om){this.Z?(this.a=[],this.b=null,dd(this)):(this.a.shift(),this.a.length?cd(this,om):(this.Ba.resolve(om),this.b=null));})).catch(ed(km,function(om){this.a=[];this.b=null;this.Z?dd(this):this.Ba.reject(om);}));}function dd(km){function lm(){var mm=Error("Task aborted.");mm.type="aborted";this.Ba.reject(mm);j.setTimeout(function(){this.Z.resolve();this.Z=null;}.bind(this),5);}km.f?km.f.then(function(){this.f=null;lm.call(this);}.bind(km)):lm.call(km);}function ed(km,lm){return lm.bind(km);}function fd(km,lm,mm,nm){MediaSource.isTypeSupported(lm);tc.call(this,nm);nm=km.addSourceBuffer(lm);this.j=km;this.c=nm;this.A=mm;this.s=new pc();this.D=null;this.v=false;this.m=null;this.l=false;this.b=[];this.C=0;this.i=this.f=this.a=null;this.B=0;this.g=lm&&lm.charAt(0);qc(this.s,this.c,"updateend",this.F.bind(this));}n(fd,tc);fd.prototype.$=function(){return {SourceBuffer:this.c};};function gd(km,lm,mm){km.Wa&&km.ia(lm,{type:km.g.charAt(0),segment:mm,sourceBuffer:km.c});}var hd=1/60;fd.prototype.destroy=function(){nd(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.s.destroy();this.j=this.c=this.s=null;};function id(km,lm){for(var mm=km.c.buffered,nm=0;nm<mm.length;++nm){var om=mm.start(nm)-hd,pm=mm.end(nm)+hd;if(lm>=om&&lm<=pm)return mm.end(nm)-lm;}return 0;}function jd(km,lm,mm){lm=lm.endTime?lm.endTime-lm.startTime:1;var nm=new eh();nm.a=3;nm.i=1000*lm;nm.c=1000*km.B;nm.m=km.D;nm.j=mm;return nm;}function kd(km,lm,mm,nm,om){if(km.a)return km=Error("Cannot fetch ("+km.g+"): previous operation not complete."),km.type="stream",h.reject(km);km.a=new ad();mm!=km.c.timestampOffset&&(km.c.timestampOffset=mm);mm=jd(km,lm,om);var pm=ph(lm.url,mm,km.A);gd(km,"SegmentFetching",lm);var qm=mh.prototype.f.bind(lm.url);km.m&&km.l&&(nm=km.m);var rm=0;nm&&(km.m=nm,km.l=false,bd(km.a,function(){return [nm.then(function(um){um.ka>rm&&(rm=um.ka);return rd(this,um,null);}.bind(this)),this.h.bind(this)];}.bind(km)));bd(km.a,ed(km,function(){return [pm.then(function(um){gd(this,"SegmentFetched",lm);um.ka>rm&&(rm=um.ka);this.A.getBandwidth();return rd(this,um,lm);}.bind(this)),function(){gd(this,"SegmentFailed",lm);qm();return this.h();}.bind(this)];}));var sm=0==km.c.buffered.length&&0==km.b.length,tm=null;bd(km.a,function(){if(0==this.c.buffered.length){var um=Error("Failed to buffer segment ("+this.g+").");um.type="stream";return [h.reject(um)];}sm&&(um=lm.startTime,tm=this.c.buffered.start(0)-um);um=bi(this.b,lm.startTime);0<=um?this.b.splice(um+1,0,lm):this.b.push(lm);}.bind(km));return qd(km).then(function(){return h.resolve({Y:tm,Ab:rm});}.bind(km));}function ld(km){if(km.a)return km=Error("Cannot clear ("+km.g+"): previous operation not complete."),km.type="stream",h.reject(km);km.a=new ad();bd(km.a,function(){var lm;lm:if(0==this.c.buffered.length){lm=h.resolve();}else{try{this.c.remove(0,this.j.duration);}catch(mm){lm=h.reject(mm);break lm;}this.b=[];lm=this.f=new yc();};return [lm,this.h.bind(this)];}.bind(km));return qd(km);}function md(km,lm){if(km.a){var mm=Error("Cannot clearAfter ("+km.g+"): previous operation not complete.");mm.type="stream";return h.reject(mm);}km.a=new ad();bd(km.a,function(){return [sd(this,lm),this.h.bind(this)];}.bind(km));return qd(km);}function nd(km){km.a?(km=km.a,km.Z?km=km.Z:km.c?(km.b&&(km.f=km.b()),km.Z=new yc(),km=km.Z):(km.c=true,km=h.resolve())):km=h.resolve();return km;}function od(km){for(var lm=km.currentTime,mm=lm,nm=0;nm<km.buffered.length;nm++)if(lm<=km.buffered.start(nm)){mm=km.buffered.start(nm);break;}return mm;}function pd(km){for(var lm=km.currentTime,mm=0;mm<km.buffered.length;mm++)if(lm>=km.buffered.start(mm)&&lm<=km.buffered.end(mm)-.05)return false;return true;}function qd(km){km.a.start();return km.a.Ba.then(ed(km,function(){this.a=null;})).catch(ed(km,function(lm){this.a=null;return h.reject(lm);}));}function rd(km,lm,mm){try{km.c.appendBuffer(lm);}catch(nm){return h.reject(nm);}km.f=new yc();km.i=mm;return km.f;}function sd(km,lm){if(0==km.c.buffered.length)return h.resolve();var mm=bi(km.b,lm);if(-1==mm||mm==km.b.length-1)return h.resolve();try{km.c.remove(km.b[mm+1].startTime,km.j.duration);}catch(nm){return h.reject(nm);}km.b=km.b.slice(0,mm+1);km.f=new yc();return km.f;}fd.prototype.h=function(){if(this.f){if("open"==this.j.readyState){var km=Error("Previous operation aborted.");km.type="abort";this.f.reject(km);this.c.abort();this.v&&(this.l=true);this.f=new yc();}return this.f;}return h.resolve();};fd.prototype.F=function(){this.f&&(this.i&&(gd(this,"SegmentAppended",this.i),this.i=null),this.f.resolve(),this.f=null);};function td(km){return String.fromCharCode.apply(null,km);}m("shaka.util.Uint8ArrayUtils.toString",td);function ud(km){for(var lm=new Uint8Array(km.length),mm=0;mm<km.length;++mm)lm[mm]=km.charCodeAt(mm);return lm;}m("shaka.util.Uint8ArrayUtils.fromString",ud);m("shaka.util.Uint8ArrayUtils.toBase64",function(km,lm){var mm=void 0==lm?true:lm,nm=j.btoa(td(km)).replace(/\+/g,"-").replace(/\//g,"_");return mm?nm:nm.replace(/=*$/,"");});function vd(km){return ud(j.atob(km.replace(/-/g,"+").replace(/_/g,"/")));}m("shaka.util.Uint8ArrayUtils.fromBase64",vd);m("shaka.util.Uint8ArrayUtils.fromHex",function(km){for(var lm=new Uint8Array(km.length/2),mm=0;mm<km.length;mm+=2)lm[mm/2]=j.parseInt(km.substr(mm,2),16);return lm;});function wd(km){for(var lm="",mm=0;mm<km.length;++mm){var nm=km[mm].toString(16);1==nm.length&&(nm="0"+nm);lm+=nm;}return lm;}m("shaka.util.Uint8ArrayUtils.toHex",wd);function xd(km,lm){if(!km&&!lm)return true;if(!km||!lm||km.length!=lm.length)return false;for(var mm=0;mm<km.length;++mm)if(km[mm]!=lm[mm])return false;return true;}function yd(){this.h=this.a="";this.l=false;this.s=this.m=null;this.i=this.g=false;this.j=this.f="";this.c=null;this.b=[];}function zd(km,lm){var mm=new yd();mm.a=km.a;mm.h=km.h;mm.l=km.l;mm.m=km.m;mm.s=km.s;mm.g=km.g;mm.i=km.i;mm.f=km.f;mm.j=km.j;mm.c=km.c?new Uint8Array(km.c.buffer):null;ae(mm,km.b);ae(mm,lm.b);return mm;}function ae(km,lm){var mm=km.b.concat(lm.map(function(nm){return {initData:new Uint8Array(nm.initData.buffer),initDataType:nm.initDataType};}));km.b=eb(mm,be);}function be(km,lm){return km.initDataType==lm.initDataType&&xd(km.initData,lm.initData);}function ce(km,lm,mm,nm){this.a=[];nm&&this.a.push(nm);}m("shaka.player.DrmSchemeInfo",ce);ce.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:1};ce.PersistentState={OPTIONAL:0,REQUIRED:1};ce.createUnencrypted=function(){return new ce(0,0,0,null);};function de(km,lm){try{var nm=new fe(km,lm);return h.resolve(nm);}catch(mm){return h.reject(mm);}}function ee(km){var lm=this.mediaKeys;lm&&lm!=km&&he(lm,null);delete this.mediaKeys;(this.mediaKeys=km)&&he(km,this);return h.resolve();}function fe(km,lm){this.a=this.keySystem=km;var mm=true;"org.w3.clearkey"==km&&(this.a="webkit-org.w3.clearkey",mm=false);var nm=false,om;om=document.getElementsByTagName("video");om=om.length?om[0]:document.createElement("video");for(var pm=0;pm<lm.length;++pm){var qm=lm[pm],rm={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:qm.initDataTypes,sessionTypes:["temporary"]},sm=false;if(qm.audioCapabilities)for(var tm=0;tm<qm.audioCapabilities.length;++tm){var um=qm.audioCapabilities[tm];um.contentType&&(sm=true,om.canPlayType(um.contentType.split(";")[0],this.a)&&(rm.audioCapabilities.push(um),nm=true));}if(qm.videoCapabilities)for(tm=0;tm<qm.videoCapabilities.length;++tm)um=qm.videoCapabilities[tm],um.contentType&&(sm=true,om.canPlayType(um.contentType,this.a)&&(rm.videoCapabilities.push(um),nm=true));sm||(nm=om.canPlayType("video/mp4",this.a)||om.canPlayType("video/webm",this.a));"required"==qm.persistentState&&(mm?(rm.persistentState="required",rm.sessionTypes=["persistent-license"]):nm=false);if(nm){this.b=rm;return;}}mm="Unsupported keySystem";if("org.w3.clearkey"==km||"com.widevine.alpha"==km)mm="None of the requested configurations were supported.";mm=Error(mm);mm.name="NotSupportedError";mm.code=DOMException.NOT_SUPPORTED_ERR;throw mm;}fe.prototype.createMediaKeys=function(){var km=new ge(this.a);return h.resolve(km);};fe.prototype.getConfiguration=function(){return this.b;};function ge(km){this.g=km;this.b=null;this.a=new pc();this.c=[];this.f={};}function he(km,lm){km.b=lm;rc(km.a);lm&&(qc(km.a,lm,"webkitneedkey",km.Tb.bind(km)),qc(km.a,lm,"webkitkeymessage",km.Sb.bind(km)),qc(km.a,lm,"webkitkeyadded",km.Qb.bind(km)),qc(km.a,lm,"webkitkeyerror",km.Rb.bind(km)));}k=ge.prototype;k.createSession=function(km){var lm=km||"temporary";if("temporary"!=lm&&"persistent-license"!=lm)throw new TypeError("Session type "+km+" is unsupported on this platform.");km=this.b||document.createElement("video");km.src||(km.src="about:blank");lm=new je(km,this.g,lm);this.c.push(lm);return lm;};k.setServerCertificate=function(){return h.reject(Error("setServerCertificate not supported on this platform."));};k.Tb=function(km){km=yb({type:"encrypted",initDataType:"webm",initData:km.initData});this.b.dispatchEvent(km);};k.Sb=function(km){var lm=ie(this,km.sessionId);lm&&(km=yb({type:"message",messageType:void 0==lm.keyStatuses.Ma()?"licenserequest":"licenserenewal",message:km.message}),lm.b&&(lm.b.resolve(),lm.b=null),lm.dispatchEvent(km));};k.Qb=function(km){if(km=ie(this,km.sessionId))le(km,"usable"),km.a&&km.a.resolve(),km.a=null;};k.Rb=function(km){var lm=ie(this,km.sessionId);if(lm){var mm=Error("EME v0.1b key error");mm.errorCode=km.errorCode;mm.errorCode.systemCode=km.systemCode;!km.sessionId&&lm.b?(mm.method="generateRequest",45==km.systemCode&&(mm.message="Unsupported session type."),lm.b.reject(mm),lm.b=null):km.sessionId&&lm.a?(mm.method="update",lm.a.reject(mm),lm.a=null):(mm=km.systemCode,km.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?le(lm,"output-restricted"):1==mm?le(lm,"expired"):le(lm,"internal-error"));}};function ie(km,lm){var mm=km.f[lm];return mm?mm:(mm=km.c.shift())?(mm.sessionId=lm,km.f[lm]=mm):null;}function je(km,lm,mm){tc.call(this,null);this.f=km;this.h=false;this.a=this.b=null;this.c=lm;this.g=mm;this.sessionId="";this.expiration=NaN;this.closed=new yc();this.keyStatuses=new me();}n(je,tc);function ke(km,lm,mm){if(km.h)return h.reject(Error("The session is already initialized."));km.h=true;var nm;try{if("persistent-license"==km.g){if(mm){nm=ud("LOAD_SESSION|"+mm);}else{var pm=new Uint8Array(lm);nm=ud("PERSISTENT|"+td(pm));}}else nm=new Uint8Array(lm);}catch(om){return h.reject(om);}km.b=new yc();try{km.f.webkitGenerateKeyRequest(km.c,nm);}catch(qm){if("InvalidStateError"!=qm.name)return km.b=null,h.reject(qm);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,nm);}catch(rm){this.b.reject(rm),this.b=null;}}.bind(km),10);}return km.b;}k=je.prototype;k.Ta=function(km,lm){if(this.a){this.a.then(this.Ta.bind(this,km,lm)).catch(this.Ta.bind(this,km,lm));}else{this.a=km;var mm,nm;"webkit-org.w3.clearkey"==this.c?(mm=td(new Uint8Array(lm)),nm=JSON.parse(mm),"oct"!=nm.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),mm=vd(nm.keys[0].k),nm=vd(nm.keys[0].kid)):(mm=new Uint8Array(lm),nm=null);try{this.f.webkitAddKey(this.c,mm,nm,this.sessionId);}catch(om){this.a.reject(om),this.a=null;}}};function le(km,lm){km.keyStatuses.Ra(lm);var mm=yb({type:"keystatuseschange"});km.dispatchEvent(mm);}k.generateRequest=function(km,lm){return ke(this,lm,null);};k.load=function(km){return "persistent-license"==this.g?ke(this,null,km):h.reject(Error("Not a persistent session."));};k.update=function(km){var lm=new yc();this.Ta(lm,km);return lm;};k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId);}this.closed.resolve();return this.closed;};k.remove=function(){return "persistent-license"!=this.g?h.reject(Error("Not a persistent session.")):this.close();};function me(){this.size=0;this.a=void 0;}var ne;k=me.prototype;k.Ra=function(km){this.size=void 0==km?0:1;this.a=km;};k.Ma=function(){return this.a;};k.forEach=function(km){this.a&&km(ne,this.a);};k.get=function(km){if(this.has(km))return this.a;};k.has=function(km){var lm=ne;return this.a&&xd(new Uint8Array(km),new Uint8Array(lm))?true:false;};function oe(km){this.systemIds=[];this.cencKeyIds=[];this.a=[];km=new hb(new DataView(km.buffer));try{for(;jb(km);){var mm=km.a,nm=lb(km),om=lb(km);1==nm?nm=mb(km):0==nm&&(nm=km.b.byteLength-mm);if(1886614376!=om){ob(km,nm-(km.a-mm));}else{var pm=kb(km);if(1<pm){ob(km,nm-(km.a-mm));}else{ob(km,3);var qm=wd(nb(km)),rm=[];if(0<pm)for(var sm=lb(km),tm=0;tm<sm;++tm){var um=wd(nb(km));rm.push(um);}var vm=lb(km);ob(km,vm);this.cencKeyIds.push.apply(this.cencKeyIds,rm);this.systemIds.push(qm);this.a.push({start:mm,end:km.a-1});km.a!=mm+nm&&ob(km,nm-(km.a-mm));}}}}catch(lm){}}function pe(km,lm){try{var nm=new qe(km,lm);return h.resolve(nm);}catch(mm){return h.reject(mm);}}function qe(km,lm){this.keySystem=km;for(var mm=false,nm=0;nm<lm.length;++nm){var om=lm[nm],pm={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:om.initDataTypes,sessionTypes:["temporary"]},qm=false;if(om.audioCapabilities)for(var rm=0;rm<om.audioCapabilities.length;++rm){var sm=om.audioCapabilities[rm];if(sm.contentType){var qm=true,tm=sm.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,tm)&&(pm.audioCapabilities.push(sm),mm=true);}}if(om.videoCapabilities)for(rm=0;rm<om.videoCapabilities.length;++rm)sm=om.videoCapabilities[rm],sm.contentType&&(qm=true,tm=sm.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,tm)&&(pm.videoCapabilities.push(sm),mm=true));qm||(mm=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==om.persistentState&&(pm.persistentState="required",pm.sessionTypes=["persistent-license"]);if(mm){this.a=pm;return;}}mm=Error("Unsupported keySystem");mm.name="NotSupportedError";mm.code=DOMException.NOT_SUPPORTED_ERR;throw mm;}qe.prototype.createMediaKeys=function(){var km=new se(this.keySystem);return h.resolve(km);};qe.prototype.getConfiguration=function(){return this.a;};function re(km){var lm=this.mediaKeys;lm&&lm!=km&&te(lm,null);delete this.mediaKeys;return (this.mediaKeys=km)?te(km,this):h.resolve();}function se(km){this.a=new MSMediaKeys(km);this.b=new pc();}se.prototype.createSession=function(km){if("temporary"!=(km||"temporary"))throw new TypeError("Session type "+km+" is unsupported on this platform.");return new ue(this.a);};se.prototype.setServerCertificate=function(){return h.reject(Error("setServerCertificate not supported on this platform."));};function te(km,lm){function mm(){lm.msSetMediaKeys(nm.a);lm.removeEventListener("loadedmetadata",mm);}rc(km.b);if(!lm)return h.resolve();qc(km.b,lm,"msneedkey",ve);var nm=km;try{return 1<=lm.readyState?lm.msSetMediaKeys(km.a):lm.addEventListener("loadedmetadata",mm),h.resolve();}catch(om){return h.reject(om);}}function ue(km){tc.call(this,null);this.c=null;this.g=km;this.b=this.a=null;this.f=new pc();this.sessionId="";this.expiration=NaN;this.closed=new yc();this.keyStatuses=new ye();}n(ue,tc);k=ue.prototype;k.generateRequest=function(km,lm){this.a=new yc();try{this.c=this.g.createSession("video/mp4",new Uint8Array(lm),null),qc(this.f,this.c,"mskeymessage",this.Ib.bind(this)),qc(this.f,this.c,"mskeyadded",this.Gb.bind(this)),qc(this.f,this.c,"mskeyerror",this.Hb.bind(this)),xe(this,"status-pending");}catch(mm){this.a.reject(mm);}return this.a;};k.load=function(){return h.reject(Error("MediaKeySession.load not yet supported"));};k.update=function(km){this.b=new yc();try{this.c.update(new Uint8Array(km));}catch(lm){this.b.reject(lm);}return this.b;};k.close=function(){try{this.c.close(),this.closed.resolve(),rc(this.f);}catch(km){this.closed.reject(km);}return this.closed;};k.remove=function(){return h.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"));};function ve(km){var lm=km.initData;if(lm){var mm=new oe(lm);if(1>=mm.a.length){km=lm;}else{var nm=[];for(km=0;km<mm.a.length;km++)nm.push(lm.subarray(mm.a[km].start,mm.a[km].end+1));lm=eb(nm,we);for(km=mm=0;km<lm.length;km++)mm+=lm[km].length;mm=new Uint8Array(mm);for(km=nm=0;km<lm.length;km++)mm.set(lm[km],nm),nm+=lm[km].length;km=mm;}}else km=lm;km=yb({type:"encrypted",initDataType:"cenc",initData:km});this.dispatchEvent(km);}function we(km,lm){return xd(km,lm);}k.Ib=function(km){this.a&&(this.a.resolve(),this.a=null);km=yb({type:"message",messageType:void 0==this.keyStatuses.Ma()?"licenserequest":"licenserenewal",message:km.message.buffer});this.dispatchEvent(km);};k.Gb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(xe(this,"usable"),this.b.resolve(),this.b=null);};k.Hb=function(){var km=Error("EME v20140218 key error");km.errorCode=this.c.error;if(null!=this.a){this.a.reject(km),this.a=null;}else if(null!=this.b){this.b.reject(km),this.b=null;}else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:xe(this,"output-not-allowed");default:xe(this,"internal-error");}};function xe(km,lm){km.keyStatuses.Ra(lm);var mm=yb({type:"keystatuseschange"});km.dispatchEvent(mm);}function ye(){this.size=0;this.a=void 0;}var ze;k=ye.prototype;k.Ra=function(km){this.size=void 0==km?0:1;this.a=km;};k.Ma=function(){return this.a;};k.forEach=function(km){this.a&&km(ze,this.a);};k.get=function(km){if(this.has(km))return this.a;};k.has=function(km){var lm=ze;return this.a&&xd(new Uint8Array(km),new Uint8Array(lm))?true:false;};function af(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(ne=(new Uint8Array([0])).buffer,Navigator.prototype.requestMediaKeySystemAccess=de,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ee,j.MediaKeys=ge,j.MediaKeySystemAccess=fe):j.MSMediaKeys?(ze=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=re,j.MediaKeys=se,j.MediaKeySystemAccess=qe,Navigator.prototype.requestMediaKeySystemAccess=pe):(Navigator.prototype.requestMediaKeySystemAccess=la,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ma,j.MediaKeys=na,j.MediaKeySystemAccess=oa));}m("shaka.polyfill.MediaKeys.install",af);m("shaka.polyfill.installAll",function(){ha();ja();cb();ra();af();});var bf=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function cf(km){var lm;km instanceof cf?(df(this,km.X),this.da=km.da,this.N=km.N,ef(this,km.ja),this.T=km.T,ff(this,km.a.clone()),this.ba=km.ba):km&&(lm=String(km).match(bf))?(df(this,lm[1]||"",true),this.da=gf(lm[2]||""),this.N=gf(lm[3]||"",true),ef(this,lm[4]),this.T=gf(lm[5]||"",true),ff(this,lm[6]||"",true),this.ba=gf(lm[7]||"")):this.a=new pf(null);}k=cf.prototype;k.X="";k.da="";k.N="";k.ja=null;k.T="";k.ba="";k.toString=function(){var km=[],lm=this.X;lm&&km.push(hf(lm,kf,true),":");if(lm=this.N){km.push("//");var mm=this.da;mm&&km.push(hf(mm,kf,true),"@");km.push(encodeURIComponent(lm).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));lm=this.ja;null!=lm&&km.push(":",String(lm));}if(lm=this.T)this.N&&"/"!=lm.charAt(0)&&km.push("/"),km.push(hf(lm,"/"==lm.charAt(0)?mf:lf,true));(lm=this.a.toString())&&km.push("?",lm);(lm=this.ba)&&km.push("#",hf(lm,of));return km.join("");};k.resolve=function(km){var lm=this.clone();"data"===lm.X&&(lm=new cf());var mm=!!km.X;mm?df(lm,km.X):mm=!!km.da;mm?lm.da=km.da:mm=!!km.N;mm?lm.N=km.N:mm=null!=km.ja;var nm=km.T;if(mm){ef(lm,km.ja);}else if(mm=!!km.T){if("/"!=nm.charAt(0))if(this.N&&!this.T){nm="/"+nm;}else{var om=lm.T.lastIndexOf("/");-1!=om&&(nm=lm.T.substr(0,om+1)+nm);}if(".."==nm||"."==nm){nm="";}else if(-1!=nm.indexOf("./")||-1!=nm.indexOf("/.")){for(var om=0==nm.lastIndexOf("/",0),nm=nm.split("/"),pm=[],qm=0;qm<nm.length;){var rm=nm[qm++];"."==rm?om&&qm==nm.length&&pm.push(""):".."==rm?((1<pm.length||1==pm.length&&""!=pm[0])&&pm.pop(),om&&qm==nm.length&&pm.push("")):(pm.push(rm),om=true);}nm=pm.join("/");}}mm?lm.T=nm:mm=""!==km.a.toString();mm?ff(lm,km.a.clone()):mm=!!km.ba;mm&&(lm.ba=km.ba);return lm;};k.clone=function(){return new cf(this);};function df(km,lm,mm){km.X=mm?gf(lm,true):lm;km.X&&(km.X=km.X.replace(/:$/,""));}function ef(km,lm){if(lm){lm=Number(lm);if(isNaN(lm)||0>lm)throw Error("Bad port number "+lm);km.ja=lm;}else km.ja=null;}function ff(km,lm,mm){lm instanceof pf?km.a=lm:(mm||(lm=hf(lm,nf)),km.a=new pf(lm));}function gf(km,lm){return km?lm?decodeURI(km):decodeURIComponent(km):"";}function hf(km,lm,mm){return "string"==typeof km?(km=encodeURI(km).replace(lm,jf),mm&&(km=km.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),km):null;}function jf(km){km=km.charCodeAt(0);return "%"+(km>>4&15).toString(16)+(km&15).toString(16);}var kf=/[#\/\?@]/g,lf=/[\#\?:]/g,mf=/[\#\?]/g,nf=/[\#\?@]/g,of=/#/g;function pf(km){this.b=km||null;}pf.prototype.a=null;pf.prototype.c=null;function qf(km,lm,mm){if(!km.a&&(km.a={},km.c=0,km.b))for(var nm=km.b.split("&"),om=0;om<nm.length;om++){var pm=nm[om].indexOf("="),qm=null,rm=null;0<=pm?(qm=nm[om].substring(0,pm),rm=nm[om].substring(pm+1)):qm=nm[om];qm=decodeURIComponent(qm.replace(/\+/g," "));rm=rm||"";qf(km,qm,decodeURIComponent(rm.replace(/\+/g," ")));}km.b=null;(nm=km.a.hasOwnProperty(lm)&&km.a[lm])||(km.a[lm]=nm=[]);nm.push(mm);km.c++;}pf.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return "";var km=[],lm;for(lm in this.a)for(var mm=encodeURIComponent(lm),nm=this.a[lm],om=0;om<nm.length;om++){var pm=mm;""!==nm[om]&&(pm+="="+encodeURIComponent(nm[om]));km.push(pm);}return this.b=km.join("&");};pf.prototype.clone=function(){var km=new pf();km.b=this.b;if(this.a){var lm={},mm;for(mm in this.a)lm[mm]=this.a[mm].concat();km.a=lm;km.c=this.c;}return km;};function rf(km,lm,mm){km=(new DOMParser()).parseFromString(km,"text/xml");if(!km)return null;lm=lm||[new cf("")];mm=mm||[new cf("")];return pg({sb:lm,u:mm},km,sf);}m("shaka.dash.mpd.parseMpd",rf);function sf(){this.id=this.url=null;this.type="static";this.b=this.j=this.u=this.sb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[];}function tf(){this.g=this.f=this.c=this.u=this.a=this.start=this.id=null;this.b=[];}function uf(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=false;this.h=this.g=this.f=this.u=null;this.j=[];this.a=[];}function vf(){this.value=null;}function wf(){this.contentType=this.lang=this.id=null;}function xf(){this.a=this.b=this.g=this.u=this.fbQualityClass=this.fbQualityLabel=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[];}function yf(){this.b=this.a=this.c=this.f=null;}function zf(){this.parsedPssh=this.psshBox=null;}function ag(){this.url=null;}function bg(){this.url=null;}function cg(){this.u=null;this.h=1;this.c=this.b=this.f=this.a=this.g=null;}cg.prototype.clone=function(){var km=new cg();km.u=tg(this.u);km.h=this.h;km.g=this.g;km.a=ug(this.a);km.f=ug(this.f);km.b=ug(this.b);km.c=ug(this.c);return km;};function dg(){this.a=this.url=null;}dg.prototype.clone=function(){var km=new dg();km.url=tg(this.url);km.a=ug(this.a);return km;};function eg(){this.a=this.url=null;}eg.prototype.clone=function(){var km=new eg();km.url=tg(this.url);km.a=ug(this.a);return km;};function fg(){this.u=null;this.a=1;this.c=this.g=null;this.i=0;this.h=null;this.b=[];this.f=null;}fg.prototype.clone=function(){var km=new fg();km.u=tg(this.u);km.a=this.a;km.g=this.g;km.c=this.c;km.i=this.i;km.h=ug(this.h);km.b=tg(this.b)||[];km.f=ug(this.f);return km;};function gg(){this.a=this.b=null;}gg.prototype.clone=function(){var km=new gg();km.b=tg(this.b);km.a=ug(this.a);return km;};function hg(){this.a=1;this.b=this.i=null;this.j=0;this.c=this.g=this.f=this.h=null;}hg.prototype.clone=function(){var km=new hg();km.a=this.a;km.i=this.i;km.b=this.b;km.j=this.j;km.h=this.h;km.f=this.f;km.g=this.g;km.c=ug(this.c);return km;};function ig(){this.a=[];}ig.prototype.clone=function(){var km=new ig();km.a=tg(this.a)||[];return km;};function jg(){this.b=this.a=this.startTime=null;}jg.prototype.clone=function(){var km=new jg();km.startTime=this.startTime;km.a=this.a;km.b=this.b;return km;};function kg(km,lm){this.ha=km;this.end=lm;}kg.prototype.clone=function(){return new kg(this.ha,this.end);};sf.TAG_NAME="MPD";tf.TAG_NAME="Period";uf.TAG_NAME="AdaptationSet";vf.TAG_NAME="Role";wf.TAG_NAME="ContentComponent";xf.TAG_NAME="Representation";yf.TAG_NAME="ContentProtection";zf.TAG_NAME="cenc:pssh";ag.TAG_NAME="BaseURL";bg.TAG_NAME="Location";cg.TAG_NAME="SegmentBase";dg.TAG_NAME="RepresentationIndex";eg.TAG_NAME="Initialization";fg.TAG_NAME="SegmentList";gg.TAG_NAME="SegmentURL";hg.TAG_NAME="SegmentTemplate";ig.TAG_NAME="SegmentTimeline";jg.TAG_NAME="S";sf.prototype.parse=function(km,lm){this.url=km.sb;this.id=vg(lm,"id",ch);this.type=vg(lm,"type",ch)||"static";this.b=vg(lm,"mediaPresentationDuration",xg);this.h=vg(lm,"minBufferTime",xg,this.h);this.g=vg(lm,"minimumUpdatePeriod",xg,this.g);this.c=vg(lm,"availabilityStartTime",wg,this.c);this.f=vg(lm,"timeShiftBufferDepth",xg,this.f);this.f=null;this.i=vg(lm,"suggestedPresentationDelay",xg,this.i);var mm=km.u,nm=rg(this,lm,ag);this.u=mg(mm,nm);if(nm=pg(this,lm,bg))this.j=ng(mm,nm.url);this.a=rg(this,lm,tf);};tf.prototype.parse=function(km,lm){this.id=vg(lm,"id",ch);this.start=vg(lm,"start",xg);this.a=vg(lm,"duration",xg);var mm=rg(this,lm,ag);this.u=mg(km.u,mm);this.c=pg(this,lm,cg);this.f=pg(this,lm,fg);this.g=pg(this,lm,hg);this.b=rg(this,lm,uf);lg(this);};function lg(km){for(var lm=[],mm=0;mm<km.b.length;++mm){var nm=km.b[mm];null!=nm.group&&(lm[nm.group]=true);}for(mm=0;mm<km.b.length;++mm)if(nm=km.b[mm],null==nm.group){for(var om=1;1==lm[om];)++om;lm[om]=true;nm.group=om;}}uf.prototype.parse=function(km,lm){var mm=pg(this,lm,wf)||{},nm=pg(this,lm,vf);this.id=vg(lm,"id",ch);this.group=vg(lm,"group",bh);this.lang=vg(lm,"lang",ch,mm.lang);this.contentType=vg(lm,"contentType",ch,mm.contentType);this.width=vg(lm,"width",ah);this.height=vg(lm,"height",ah);this.b=vg(lm,"mimeType",ch);this.i=vg(lm,"codecs",ch);this.c=nm&&"main"==nm.value;this.lang&&(this.lang=dc(this.lang));mm=rg(this,lm,ag);this.u=mg(km.u,mm);this.j=rg(this,lm,yf);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=km.c?og(this,lm,km.c):pg(this,lm,cg);this.g=km.f?og(this,lm,km.f):pg(this,lm,fg);this.h=km.g?og(this,lm,km.g):pg(this,lm,hg);this.a=rg(this,lm,xf);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]));};vf.prototype.parse=function(km,lm){this.value=vg(lm,"value",ch);};wf.prototype.parse=function(km,lm){this.id=vg(lm,"id",ch);this.lang=vg(lm,"lang",ch);this.contentType=vg(lm,"contentType",ch);this.lang&&(this.lang=dc(this.lang));};xf.prototype.parse=function(km,lm){this.id=vg(lm,"id",ch);this.bandwidth=vg(lm,"bandwidth",ah);this.width=vg(lm,"width",ah,km.width);this.height=vg(lm,"height",ah,km.height);this.f=vg(lm,"mimeType",ch,km.b);this.h=vg(lm,"codecs",ch,km.i);this.fbQualityLabel=vg(lm,"FBQualityLabel",ch);this.fbQualityClass=vg(lm,"FBQualityClass",ch);this.lang=km.lang;var mm=rg(this,lm,ag);this.u=mg(km.u,mm);this.c=rg(this,lm,yf);this.g=km.f?og(this,lm,km.f):pg(this,lm,cg);this.b=km.g?og(this,lm,km.g):pg(this,lm,fg);this.a=km.h?og(this,lm,km.h):pg(this,lm,hg);this.c=this.c.concat(km.j);};yf.prototype.parse=function(km,lm){this.f=lm;this.c=vg(lm,"schemeIdUri",ch);var mm=vg(lm,"cenc:default_KID",ch);mm&&(this.b=mm.replace(/[-]/g,""));this.a=pg(this,lm,zf);};zf.prototype.parse=function(km,lm){var mm=sg(lm);if(mm){this.psshBox=vd(mm);try{this.parsedPssh=new oe(this.psshBox);}catch(nm){if(!(nm instanceof RangeError))throw nm;}}};ag.prototype.parse=function(km,lm){this.url=sg(lm);};bg.prototype.parse=function(km,lm){this.url=sg(lm);};cg.prototype.parse=function(km,lm){this.u=km.u||this.u;this.h=vg(lm,"timescale",ah,this.h);this.g=vg(lm,"presentationTimeOffset",bh,this.g);this.a=vg(lm,"indexRange",yg,this.a);this.f=vg(lm,"FBFirstSegmentRange",yg,this.f);this.b=pg(this,lm,dg)||this.b;this.c=pg(this,lm,eg)||this.c;};dg.prototype.parse=function(km,lm){var mm=vg(lm,"sourceURL",ch);this.url=ng(km.u,mm);this.a=vg(lm,"range",yg,ug(km.a));};eg.prototype.parse=function(km,lm){var mm=vg(lm,"sourceURL",ch);this.url=ng(km.u,mm);this.a=vg(lm,"range",yg);};fg.prototype.parse=function(km,lm){this.u=km.u||this.u;this.a=vg(lm,"timescale",ah,this.a);this.g=vg(lm,"presentationTimeOffset",bh,this.g);this.c=vg(lm,"duration",ah,this.c);var mm=vg(lm,"startNumber",ah);null!=mm&&(this.i=mm);this.h=pg(this,lm,eg)||this.h;this.b=(mm=rg(this,lm,gg))&&0<mm.length?mm:this.b;this.f=pg(this,lm,ig)||this.f;};gg.prototype.parse=function(km,lm){var mm=vg(lm,"media",ch);this.b=ng(km.u,mm);this.a=vg(lm,"mediaRange",yg);};hg.prototype.parse=function(km,lm){this.a=vg(lm,"timescale",ah,this.a);this.i=vg(lm,"presentationTimeOffset",bh,this.i);this.b=vg(lm,"duration",ah,this.b);var mm=vg(lm,"startNumber",bh);null!=mm&&(this.j=mm);this.h=vg(lm,"media",ch,this.h);this.f=vg(lm,"index",ch,this.f);this.g=vg(lm,"initialization",ch,this.g);this.c=pg(this,lm,ig)||this.c;};ig.prototype.parse=function(km,lm){this.a=rg(this,lm,jg);};jg.prototype.parse=function(km,lm){this.startTime=vg(lm,"t",bh);this.a=vg(lm,"d",bh);this.b=vg(lm,"r",zg);};function mg(km,lm){if(!lm||0===lm.length)return km;for(var mm=[],nm=0;nm<lm.length;nm++){var om=lm[nm].url;null==km||0===km.length?mm.push(new cf(om)):(om=ng(km.slice(0,1),om),mm.push(om[0]));}return mm;}function ng(km,lm){if(!lm)return km;var mm=new cf(lm);return km?km.map(function(nm){return nm.resolve(mm);}):[mm];}function og(km,lm,mm){var nm=ug(mm);(lm=qg(lm,mm.constructor.TAG_NAME))&&nm.parse(km,lm);return nm;}function pg(km,lm,mm){var nm=null;if(lm=qg(lm,mm.TAG_NAME))nm=new mm(),nm.parse(km,lm);return nm;}function qg(km,lm){for(var mm=null,nm=0;nm<km.childNodes.length;nm++)if(km.childNodes[nm].tagName==lm){if(mm)return null;mm=km.childNodes[nm];}return mm;}function rg(km,lm,mm){for(var nm=[],om=0;om<lm.childNodes.length;om++)if(lm.childNodes[om].tagName==mm.TAG_NAME){var pm=new mm();pm.parse.call(pm,km,lm.childNodes[om]);nm.push(pm);}return nm;}function sg(km){km=km.firstChild;return km.nodeType!=Node.TEXT_NODE?null:km.nodeValue;}function tg(km){return km?km.map(function(lm){return lm.clone();}):null;}function ug(km){return km?km.clone():null;}function vg(km,lm,mm,nm){km=mm(km.getAttribute(lm));return null!=km?km:void 0!==nm?nm:null;}function wg(km){if(!km)return null;km=Date.parse(km);return isNaN(km)?null:Math.floor(km/1000);}function xg(km){if(!km)return null;var lm=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(km);if(!lm)return null;km=0;var mm=bh(lm[1]);mm&&(km+=31536000*mm);(mm=bh(lm[2]))&&(km+=2592000*mm);(mm=bh(lm[3]))&&(km+=86400*mm);(mm=bh(lm[4]))&&(km+=3600*mm);(mm=bh(lm[5]))&&(km+=60*mm);lm=j.parseFloat(lm[6]);(lm=isNaN(lm)?null:lm)&&(km+=lm);return km;}function yg(km){var lm=/([0-9]+)-([0-9]+)/.exec(km);if(!lm)return null;km=bh(lm[1]);if(null==km)return null;lm=bh(lm[2]);return null==lm?null:new kg(km,lm);}function zg(km){km=j.parseInt(km,10);return isNaN(km)?null:km;}function ah(km){km=j.parseInt(km,10);return 0<km?km:null;}function bh(km){km=j.parseInt(km,10);return 0<=km?km:null;}function ch(km){return km;}function dh(km,lm){this.url=km;this.b=lm||new eh();this.g=this.j=this.h=0;this.a=null;this.c=new yc();this.f=null;}m("shaka.util.AjaxRequest",dh);function eh(){this.body=null;this.a=1;this.i=1000;this.c=0;this.method="GET";this.g="arraybuffer";this.b={};this.h=this.l=false;this.f=this.m=null;this.j=false;}var fh=true;function gh(km){hh(km);km.b.body=null;km.c.destroy();km.c=null;km.f=null;}function hh(km){km.a&&(km.a.onload=null,km.a.onreadystatechange=null,km.a.onerror=null,km.a.ontimeout=null);km.a=null;}var ih=/(.*)\.(xx|fna)\.fbcdn\.net/,jh=/livestream-lookaside\.facebook\.com$/;dh.prototype.i=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var km=this.url.split(":")[1].split(";").pop().split(","),lm=km.pop(),lm="base64"==km.pop()?j.atob(lm.replace(/-/g,"+").replace(/_/g,"/")):j.decodeURIComponent(lm);"arraybuffer"==this.b.g&&(lm=ud(lm).buffer);km=JSON.parse(JSON.stringify(new XMLHttpRequest()));km.response=lm;km.responseText=lm.toString();lm=this.c;lm.resolve(km);gh(this);return lm;}if(0==this.url.lastIndexOf("idb:",0))return this.A();this.h++;this.j=Date.now();this.g||(this.g=this.b.i);this.a=new XMLHttpRequest();var mm=this.url,km=new cf(mm);fh&&(this.f&&!this.f.supportsCaching()||this.b.h)&&qf(km.a,"_",Date.now());mm=ih.test(mm);if(null!=this.b.f&&mm){var nm=this.b.f,om=km.a;qf(om,"_nc_p_n",nm.f);null!=nm.c?qf(om,"_nc_p_ts",nm.c):null!=nm.b&&qf(om,"_nc_p_o",nm.b);null!=nm.a&&qf(om,"_nc_p_rid",nm.a);}1==this.b.j&&mm&&qf(km.a,"_nc_playing",1);mm=km.toString();km=jh.test(km.N);this.a.open(this.b.method,mm,true);this.a.responseType=this.b.g;this.a.timeout=this.b.c;this.a.withCredentials=this.b.l||km;this.a.onload=this.l.bind(this);this.a.onreadystatechange=this.m.bind(this);this.a.onerror=this.v.bind(this);this.a.ontimeout=this.s.bind(this);for(lm in this.b.b)this.a.setRequestHeader(lm,this.b.b[lm]);this.a.send(this.b.body);return this.c;};dh.prototype.send=dh.prototype.i;function kh(km,lm,mm){lm=Error(lm);lm.type=mm;lm.status=km.a.status;lm.url=km.url;lm.method=km.b.method;lm.body=km.b.body;lm.fc=km.a;return lm;}dh.prototype.l=function(km){this.f&&this.f.sample(Date.now()-this.j,km.loaded);km=[403];200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),gh(this)):this.h<this.b.a&&-1===km.indexOf(this.a.status)?lh(this):(km=kh(this,"HTTP error.","net"),this.c.reject(km),gh(this));};dh.prototype.m=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED&&(this.a.ka=Date.now()-this.j,this.b.h)){var km=Date.parse(this.a.getResponseHeader("Date"));km&&(gb=km-Date.now());}};dh.prototype.v=function(){var km=kh(this,"Network failure.","net");this.c.reject(km);gh(this);};dh.prototype.s=function(){if(this.h<this.b.a){lh(this);}else{var km=kh(this,"Request timed out.","net");this.c.reject(km);gh(this);}};function lh(km){hh(km);j.setTimeout(km.i.bind(km),km.g*(1+.5*(2*Math.random()-1)));km.g*=2;}function mh(km,lm,mm,nm){this.b=lm;this.h=mm||0;this.g=null!=nm?nm:null;this.c=this.a=null;this.j=km;this.i=null;}var nh;m("shaka.util.FailoverUri",mh);function oh(km,lm){return km&&0!==km.length?km.map(function(mm){return mm.resolve(lm);}):[lm];}mh.setPrefetchCacheValueGetter=function(km){nh=km;};function ph(km,lm,mm){if(km.a)return km.a;km.a=qh(km,0,lm||new eh(),mm);return km.a;}mh.prototype.f=function(){if(this.c){this.a=null;var km=this.c;if(km.a&&km.a.readyState!=XMLHttpRequest.DONE){km.a.abort();var lm=kh(km,"Request aborted.","aborted");km.c.reject(lm);gh(km);}this.i=this.c=null;}};function qh(km,lm,mm,nm){var om=km.b[lm].toString();if(km.h||km.g){var pm=km.b[lm].N;!pm.endsWith("fbcdn.net")||pm.startsWith("interncache")||pm.endsWith("ak.fbcdn.net")?mm.b.Range="bytes="+(km.h+"-"+(null!=km.g?km.g:"")):om+="&bytestart="+km.h+"&byteend="+km.g;}km.j&&(om=km.j(om,mm.b)||om);pm=null;nh&&(pm=nh(om));pm||(km.c=new dh(om,mm),nm&&(km.c.f=nm),pm=km.c.i());om=pm.then(ed(km,function(qm){this.i=this.c=this.a=null;this.i=qm.a?new cf(qm.a):this.b[lm];qm.response.ka=qm.ka;return h.resolve(qm.response);}));return om=om.catch(ed(km,function(qm){if(this.a&&lm+1<this.b.length)return this.a=qh(this,lm+1,mm,nm);this.a=this.c=null;return h.reject(qm);}));}mh.prototype.clone=function(){return new mh(this.j,this.b.map(function(km){return km.clone();}),this.h,this.g);};mh.prototype.toString=function(){return this.b[0].toString();};function rh(km,lm,mm){this.a=new eh();this.a.g="text";this.a.a=3;this.a.c=1000*(null!=lm?lm:0);mm&&(this.a.f=mm);this.a.h=true;this.b=km;}function sh(km){var lm=km.b;return ph(lm,km.a).then(function(mm){mm instanceof ArrayBuffer&&(mm=String.fromCharCode.apply(null,new Uint8Array(mm)));if(mm=rf(mm,lm.b,[lm.i]))return h.resolve(mm);mm=Error("MPD parse failure.");mm.type="dash";return h.reject(mm);});}function th(km){this.f=km;this.a=this.b=this.c=null;}function uh(km,lm,mm,nm){for(var om=lm.a,pm=[],qm=0;qm<nm;++qm){var rm=qm+mm,sm=(rm-1)*om.b,tm=sm/om.a,um=(sm+om.b)/om.a,rm=vh(km,lm,om.j+rm-1,sm);if(!rm)return null;pm.push(new zh(tm,um,rm,sm));}return pm;}function vh(km,lm,mm,nm){if(!lm.a)return null;var om=lm.a.h;if(!om)return lm.u?new mh(km,lm.u,0,null):null;mm=wh(om,lm.id,mm,lm.bandwidth,nm);if(!mm)return null;lm=oh(lm.u,mm);return new mh(km,lm,0,null);}function wh(km,lm,mm,nm,om){var pm={RepresentationID:lm,Number:mm,Bandwidth:nm,Time:om};km=km.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(rm,sm,tm){if("$$"==rm)return "$";var um=pm[sm];if(null==um)return rm;"RepresentationID"==sm&&tm&&(tm=void 0);rm=um.toString();tm=j.parseInt(tm,10)||1;tm=Math.max(0,tm-rm.length);return Array(tm+1).join("0")+rm;});try{return new cf(km);}catch(qm){if(qm instanceof URIError)return null;throw qm;}}function xh(km,lm,mm){var nm=0;lm*=mm;km=km.a;mm=[];for(var om=0;om<km.length&&km[om].a;++om){var pm=km[om].startTime,pm=null!=pm?pm:nm,qm=km[om].b||0;0>qm&&(qm=km[om].a,qm=om+1===km.length?Math.ceil((km[0].startTime+lm-pm)/qm)-1:Math.ceil((km[om+1].startTime-pm)/qm)-1);0<mm.length&&pm!=nm&&(mm[mm.length-1].end=pm);for(var rm=0;rm<=qm;++rm)nm=pm+km[om].a,mm.push({start:pm,end:nm}),pm=nm;}return mm;}function yh(km,lm){this.a=km;this.b=lm||null;}yh.prototype.destroy=function(){this.a&&(this.a.f(),this.a=null);this.b=null;};yh.prototype.create=function(){return this.a?ph(this.a):h.resolve(this.b);};function zh(km,lm,mm,nm){this.startTime=km;this.endTime=lm;this.url=mm;this.a=null!=nm?nm:null;}function ai(km,lm,mm){return new zh(lm,mm,km.url,null!=km.a?km.a:void 0);}function bi(km,lm){for(var mm=km.length-1;0<=mm;--mm){var nm=km[mm];if(lm>=nm.startTime&&(null==nm.endTime||lm<nm.endTime))return mm;}return -1;}function ci(km,lm){return km.map(function(mm){return ai(mm,mm.startTime+lm,null!=mm.endTime?mm.endTime+lm:null);});}function di(){}di.prototype.parse=function(km,lm,mm,nm,om){var pm=null;try{km:{var rm=[],sm=new hb(km),tm=lb(sm);if(1936286840!=lb(sm)){pm=null;}else{1==tm&&(tm=mb(sm));var um=kb(sm);ob(sm,3);ob(sm,4);var vm=lb(sm);if(0==vm){pm=null;}else{var wm,xm;0==um?(wm=lb(sm),xm=lb(sm)):(wm=mb(sm),xm=mb(sm));ob(sm,2);var ym=sm.b.getUint16(sm.a,sm.c);sm.a+=2;km=wm;lm=lm+tm+xm;for(xm=tm=0;xm<ym;xm++){var zm=lb(sm);wm=(zm&2147483648)>>>31;var um=zm&2147483647,an=lb(sm);lb(sm);if(1==wm){pm=null;break km;}var bn;bn=0==xm&&om?om:new mh(nm,mm,lm,lm+um-1);wm=km/vm;var cn=(km+an)/vm;0===xm&&(tm=wm);rm.push(new zh(wm-tm,cn-tm,bn));km+=an;lm+=um;}pm=rm;}}};}catch(qm){if(!(qm instanceof RangeError))throw qm;}return pm;};function ei(km){this.a=km;this.Y=0;this.g=[];this.Ua=false;}ei.prototype.H=function(){return !!this.g[this.g.length-1];};ei.prototype.lastPollHadChanges=ei.prototype.H;ei.prototype.D=function(){var km=this.g,lm=km.lastIndexOf(true);if(1>lm)return 0;km=km.lastIndexOf(true,lm-1);return 0>km?0:lm-km-1;};ei.prototype.getFetchesBetweenRecentChanges=ei.prototype.D;ei.prototype.C=function(){return Math.floor((this.g.length-1-this.g.lastIndexOf(true))/2);};ei.prototype.getConsecutiveUpdatesWithoutChanges=ei.prototype.C;ei.prototype.B=function(){return this.g.length-1-this.g.lastIndexOf(false);};ei.prototype.getConsecutiveUpdatesWithChanges=ei.prototype.B;ei.prototype.destroy=function(){this.a=null;};ei.prototype.length=function(){return this.a.length;};ei.prototype.F=function(){return (this.a||[]).slice();};ei.prototype.getSegments=ei.prototype.F;function fi(km){if(0==km.a.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return km.a[0];}ei.prototype.w=function(){if(0==this.a.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.a[this.a.length-1];};ei.prototype.last=ei.prototype.w;k=ei.prototype;k.get=function(km){if(0>km||km>=this.a.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.a[km];};k.na=function(km){km=bi(this.a,km);return 0<=km?this.a[km]:null;};k.Oa=function(km){gi(this,km);return true;};function gi(km,lm){km.Y!=lm.Y&&(lm=new ei(ci(lm.a,km.Y-lm.Y)));if(0==km.length()){km.a=lm.a.slice(0);}else if(0!=lm.length()&&null!=km.w().endTime)if(null!=lm.w().endTime&&lm.w().endTime<km.w().endTime){km.Ua=true;}else{km.Ua=false;if(km.w().endTime<=fi(lm).startTime){var mm=ai(km.w(),km.w().startTime,fi(lm).startTime),mm=km.a.slice(0,-1).concat([mm]);}else{var nm;for(nm=0;nm<km.a.length&&!(km.a[nm].endTime>=fi(lm).startTime);++nm);km.a[nm].startTime<fi(lm).startTime?(mm=ai(km.a[nm],km.a[nm].startTime,fi(lm).startTime),mm=km.a.slice(0,nm).concat([mm])):(fi(km).startTime>fi(lm).startTime||fi(lm),mm=km.a.slice(0,nm));}km.a=mm.concat(lm.a);}}k.ma=function(km){var lm=km-this.Y;if(0==lm)return 0;this.a=ci(this.a,lm);this.Y=km;return lm;};k.Ka=function(){return 0<this.length()?{start:fi(this).startTime,end:this.w().endTime}:{start:0,end:0};};function hi(km,lm,mm,nm){ei.call(this,km);this.i=lm;this.A=mm;this.h=nm;this.j=this.i.b||this.i.a.reduce(function(om,pm){return null==pm.a?NaN:om+pm.a;},0)||0;this.b=this.s=this.f=null;ii(this);}n(hi,ei);hi.prototype.destroy=function(){this.A=this.i=null;ei.prototype.destroy.call(this);};hi.prototype.na=function(km){ki(this,fb()/1000);return ei.prototype.na.call(this,km);};hi.prototype.Oa=function(km){if(!(km instanceof hi))return false;gi(this,km);this.j=Math.max(this.j,km.j);null==this.f?(this.h=km.h,ii(this)):li(this);return true;};function ii(km){li(km);if(0!=km.length()){km.length();var lm=null!=km.w().endTime?km.w().endTime:km.w().startTime;if(km.i.c>km.h){km.f=lm;}else{var mm=km.h-(km.i.c+km.A.start);0>mm?km.f=lm:mm<Math.max(km.w().startTime,km.w().endTime||0)?(km.w(),km.f=lm):km.f=mm;}km.s=km.w().startTime;km.b=fi(km).startTime;}}hi.prototype.ma=function(km){km=ei.prototype.ma.call(this,km);Math.min.apply(null,this.a.filter(function(lm){return null!=lm.endTime;}).map(function(lm){return lm.endTime-lm.startTime;}));null!=this.f&&(this.s+=km,this.b+=km,this.f+=km);return km;};hi.prototype.Ka=function(){return ji(this,fb()/1000);};function ji(km,lm){ki(km,lm);if(null==km.f||null==km.s||null==km.b)return {start:0,end:0};var mm=Number.POSITIVE_INFINITY;km.j&&(mm=km.j);var nm=lm-km.h,om=km.f+nm;null!=km.i.f&&(om=om-km.b-km.i.f,0<om&&(km.b+=om));km.b=Math.min(km.b,mm);nm=km.s+nm;if(nm<km.b)return {start:km.b,end:km.b};nm=0<km.length()?null!=km.w().endTime?Math.min(nm,km.w().endTime):nm:km.b;nm=Math.max(nm,km.b);nm=Math.min(nm,mm);return {start:km.b,end:nm};}function ki(km,lm){li(km);if(null!=km.i.f)if(null==km.f){km.length();}else{for(var mm=km.f+(lm-km.h),nm=0,om=0;om<km.a.length;++om){var pm=null;om<km.a.length-1?pm=km.a[om+1].endTime:(pm=km.a[om],pm=null!=pm.endTime?pm.endTime+(pm.endTime-pm.startTime):null);if(null!=pm&&pm<mm-km.i.f){++nm;}else break;}0<nm&&km.a.splice(0,nm);}}function li(km){if(km.j){for(var lm=0,mm=km.a.length-1;0<=mm;--mm)if(km.a[mm].startTime>km.j){++lm;}else break;0<lm&&km.a.splice(-lm);}}function mi(km,lm,mm,nm,om){var pm=1,qm=0,rm;if(km.c>nm){rm=null;}else{var sm=km.i||0,tm=km.f||0;rm=mm.a;rm=rm.b/rm.a;var um=nm-(km.c+lm.start);0>um?rm=null:(tm=um-2*rm-tm,0>tm&&(tm=0),tm=Math.ceil(tm/rm)*rm,um-=rm,0>um?rm=null:(sm=Math.floor(um/rm)*rm-sm,0>sm&&(sm=0),sm=Math.floor(sm/rm)*rm,rm={cb:tm/rm+1,current:(sm>=tm?sm:tm)/rm+1}));}rm&&(pm=rm.cb,qm=rm.current-rm.cb+1);pm=uh(om,mm,pm,qm);if(null==pm)throw km=Error("Failed to generate SegmentReferences."),km.type="stream",km;hi.call(this,pm,km,lm,nm);this.v=mm;this.m=this.c=0<this.length()?km.c+lm.start+this.w().endTime:null;this.l=rm?rm.current+1:null;this.U=om;}n(mi,hi);mi.prototype.destroy=function(){this.U=this.v=null;hi.prototype.destroy.call(this);};mi.prototype.na=function(km){var lm=fb()/1000;ni(this,lm);ki(this,lm);return ei.prototype.na.call(this,km);};mi.prototype.Oa=function(km){if(null!=this.c||!(km instanceof mi)||null==km.c)return false;this.c=km.c;this.m=km.m;this.l=km.l;this.h=km.h;this.j=km.j;gi(this,km);ni(this,fb()/1000);ii(this);return true;};mi.prototype.ma=function(km){km=hi.prototype.ma.call(this,km);null!=this.c&&(this.c+=km,this.m+=km);return km;};mi.prototype.Ka=function(){var km=fb()/1000;ni(this,km);return ji(this,km);};function ni(km,lm){if(null!=km.c&&null!=km.m&&null!=km.l){var mm=km.v.a,mm=mm.b/mm.a,nm=Math.floor((km.m+(lm-km.h)-km.c)/mm);if(0!=nm){var om=uh(km.U,km.v,km.l,nm);Array.prototype.push.apply(km.a,ci(om,km.Y));km.c+=nm*mm;km.l+=nm;}}}function oi(km,lm,mm,nm,om){this.f=km;this.b=lm;this.c=mm;this.h=nm;this.a=null;this.g=om;}oi.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null);};oi.prototype.create=function(){if(this.a)return h.resolve(this.a);if("dynamic"==this.f.type){try{this.a=new mi(this.f,this.b,this.c,this.h,this.g);}catch(km){return h.reject(km);}}else{var lm;lm=this.c.a;if(lm=uh(this.g,this.c,1,Math.ceil(this.b.a/(lm.b/lm.a)))){if(0<lm.length){var mm=lm[lm.length-1];lm[lm.length-1]=ai(mm,mm.startTime,this.b.a);}lm=new ei(lm);}else lm=null;this.a=lm;if(!this.a)return lm=Error("Failed to generate SegmentReferences"),lm.type="stream",h.reject(lm);}return h.resolve(this.a);};function pi(km,lm,mm,nm,om){this.c=km;this.b=lm;this.g=mm;this.a=null;this.h=nm;this.f=om;}pi.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);};pi.prototype.create=function(){if(this.a)return h.resolve(this.a);var km=this.g.b,lm=[];km.f&&(lm=xh(km.f,km.a||1,this.b.a||0));var mm=0;km.c&&km.i?mm=(km.i-1)*km.c:0<lm.length&&(mm=lm[0].start-(km.g||0));var nm=mm,om=km.b.length;0<lm.length&&lm.length!=km.b.length&&(om=Math.min(lm.length,km.b.length));for(var pm=[],qm=0;qm<om;++qm){var rm=km.b[qm],sm=mm/km.a,tm=null,um=null;km.c?(tm=mm+km.c,um=tm/km.a):0<lm.length?(tm=lm[qm].end-(km.g||0),um=tm/km.a):(um=sm+this.b.a,tm=um*km.a);var mm=tm,tm=0,vm=null;rm.a&&(tm=rm.a.ha,vm=rm.a.end);um=Math.min(this.b.a+nm/km.a,um);pm.push(new zh(sm,um,new mh(this.f,rm.b,tm,vm)));}"dynamic"==this.c.type?this.a=new hi(pm,this.c,this.b,this.h):this.a=new ei(pm);return h.resolve(this.a);};function qi(km,lm,mm,nm,om){this.b=km;this.c=lm;this.f=mm;this.h=nm;this.a=null;this.g=om;}qi.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null);};qi.prototype.create=function(){if(this.a)return h.resolve(this.a);for(var km=this.f.a,lm=xh(km.c,km.a||1,this.c.a||0),mm=[],nm=0;nm<lm.length;++nm){var om=lm[nm].start,pm=om/km.a,qm=lm[nm].end/km.a,rm=vh(this.g,this.f,nm+km.j,om);if(!rm)return km=Error("Failed to generate media URL."),km.type="dash",h.reject(km);var sm=(km.i||0)/km.a;mm.push(new zh(pm-sm,qm-sm,rm,om));}"dynamic"==this.b.type?this.a=new hi(mm,this.b,this.c,this.h):this.a=new ei(mm);return h.resolve(this.a);};function ri(){this.G=si++;this.id=this.M=this.K=null;this.b=0;this.height=this.width=this.bandwidth=null;this.c=this.a="";this.switchReason=this.fbQualityClass=this.fbQualityLabel=null;this.f=[];this.S=false;this.J=true;}var si=0;ri.prototype.destroy=function(){this.K&&(this.K.destroy(),this.K=null);this.M&&(this.M.destroy(),this.M=null);};function ti(km){var lm=km.a||"";km.c&&(lm+='; codecs="'+km.c+'"');return lm;}function ui(){this.G=vi++;this.id=null;this.contentType=this.lang="";this.b=false;this.o=[];this.a=[];}var vi=0;ui.prototype.destroy=function(){for(var km=0;km<this.o.length;++km)this.o[km].destroy();this.a=this.o=null;};function wi(km){for(var lm=[],mm=0;mm<km.a.length;++mm){var nm=new zi();nm.id=km.G;nm.a=km.a[mm];nm.contentType=km.contentType;nm.b=km.o.length?ti(km.o[0]):"";lm.push(nm);}return lm;}function xi(){this.id=null;this.start=0;this.b=null;this.a=[];}xi.prototype.destroy=function(){for(var km=0;km<this.a.length;++km)this.a[km].destroy();this.a=null;};function yi(){this.b=false;this.h=this.g=this.f=null;this.c=0;this.a=[];this.i=false;}yi.prototype.destroy=function(){for(var km=0;km<this.a.length;++km)this.a[km].destroy();this.a=null;};function zi(){this.id=0;this.a=null;this.b=this.contentType="";}function aj(km,lm,mm,nm,om,pm){tc.call(this,km);this.b=lm;this.a=new fd(mm,nm,om,this);this.R=0;this.F=this.v=this.c=null;this.L=false;this.g=this.A=null;this.m=false;this.C=0;this.D=false;this.j=null;this.i=false;this.h=new yc();this.l=this.f=false;this.s=0;this.B=15;this.W=this.O=false;this.V=pm;this.H=this.P=false;}n(aj,tc);aj.prototype.$=function(){return {SourceBufferManager:this.a};};aj.prototype.getDebug=aj.prototype.$;aj.prototype.I=function(km){null!=km.initialStreamBufferSize&&(this.s=Number(km.initialStreamBufferSize));null!=km.dynamicStreamBufferSize&&(this.C=Number(km.dynamicStreamBufferSize));null!=km.streamBufferSize&&(this.B=Number(km.streamBufferSize));null!=km.addCdnDebugQueryParameters&&(this.O=Boolean(km.addCdnDebugQueryParameters));null!=km.useInitialBufferSizeWhenPaused&&(this.W=Boolean(km.useInitialBufferSizeWhenPaused));null!=km.segmentRequestTimeout&&(this.a.B=Number(km.segmentRequestTimeout));null!=km.resolveVideoTimeUpdateOnFragmentedTimeRanges&&(this.P=Boolean(km.resolveVideoTimeUpdateOnFragmentedTimeRanges));null!=km.reappendInitSegmentAfterAbort&&(this.a.v=Boolean(km.reappendInitSegmentAfterAbort));};aj.prototype.destroy=function(){ij(this);this.h.destroy();this.c=this.h=null;this.a.destroy();this.U=this.b=this.a=null;};k=aj.prototype;k.va=function(){return this.c;};k.La=function(){return this.v;};k.zb=function(km){this.f||km.then(function(){this.f=true;this.g||hj(this,0);}.bind(this)).catch(function(){});return this.h;};k.Na=function(){return this.l;};k.wa=function(km,lm,mm,nm){km!=this.c&&(this.F=km.M.create(),km.K.create().then(ed(this,function(om){if(this.b){var pm=this.c;this.c=km;this.v=om;this.L=true;this.A=nm?nm:null;this.m||(pm?lm&&bj(this,true,mm):hj(this,0));}})).catch(ed(this,function(om){"aborted"!=om.type&&(this.f?(om=zb(om),this.dispatchEvent(om)):this.h.reject(om));})));};k.vb=function(){return bj(this,false);};k.wb=function(){this.D=true;};function bj(km,lm,mm){km.c&&!km.m&&(km.m=true,ij(km),nd(km.a).then(ed(km,function(){var nm=this.b.currentTime;if(!lm&&0<id(this.a,nm)&&0<=bi(this.a.b,nm))return h.resolve();if(mm)return md(this.a,this.b.currentTime+mm);this.H=true;return ld(this.a);})).then(ed(km,function(){this.m=false;hj(this,0);})).catch(ed(km,function(nm){this.m=false;this.f?(nm=zb(nm),this.dispatchEvent(nm)):this.h.reject(nm);})));}k.xb=function(km){return 0<id(this.a,km)&&0<=bi(this.a.b,km);};k.za=function(){};k.Ia=function(){return true;};function cj(km){var lm=km.W&&km.b.paused?km.s:km.B;km.C&&!km.b.paused&&(lm=Math.max(Math.min(km.v.w().endTime-km.b.currentTime,km.C),km.B));return km.i?Math.max(km.s,lm):km.s;}k.Pb=function(){if(this.i&&!this.f){this.g=null;}else{var km;if(km=this.f&&!this.l)km=1<this.a.c.buffered.length?true:false;if(km&&(this.D||pd(this.b))){this.P&&(this.b.currentTime=od(this.b)),this.D=false,bj(this,true);}else{this.g=null;km=this.c;var lm=this.v,mm=this.b.currentTime;if(id(this.a,this.i?mm:mm+(this.j||0))>=cj(this)){ej(this),hj(this,1000/(5*(Math.abs(this.b.playbackRate)||1)));}else{var nm=dj(this,mm,lm);nm?(lm=kd(this.a,nm,km.b,this.F,this.O&&!this.b.paused),this.V&&"video"===km.a.split("/")[0]&&this.V(nm.startTime,nm.endTime,{id:km.id,reason:this.A}),this.F=null,this.L&&(this.L=false,nm=this.A,this.A=null,fj(this,km,nm)),this.l=false,lm.then(ed(this,function(om){var pm=om.Y;om=om.Ab;this.i||(this.R=om);null==this.j&&(this.j=pm);this.H&&0<id(this.a,mm)&&(this.H=false,this.b.currentTime+=.001);hj(this,0);})).catch(ed(this,function(om){if("aborted"!=om.type){var pm=[0,404,410,502,503,504];"net"==om.type&&-1!=pm.indexOf(om.fc.status)&&this.c&&hj(this,1000);om=zb(om);this.dispatchEvent(om);}}))):(ej(this),this.f&&!this.l&&(this.l=true,gj(this)),hj(this,200));}}}};function dj(km,lm,mm){km=km.a;var nm=km.b.length;km=0<nm?km.b[nm-1]:null;return null!=km?null!=km.endTime?mm.na(km.endTime):null:mm.na(lm)||(mm.length()?mm.w():null);}function ej(km){if(!km.i&&null!=km.j){km.i=true;var lm=km.a,mm=km.j,nm=mm-lm.C;0!=nm&&(lm.b=ci(lm.b,nm),lm.C=mm);km.h.resolve(km.j);}}function fj(km,lm,mm){var nm=lm.a.split("/")[0];lm=yb({type:"adaptation",bubbles:true,contentType:nm,size:"video"!=nm?null:{width:lm.width,height:lm.height},bandwidth:lm.bandwidth,reason:mm});km.dispatchEvent(lm);}function gj(km){var lm=yb({type:"ended"});km.dispatchEvent(lm);}function hj(km,lm){km.g=j.setTimeout(km.Pb.bind(km),lm);}function ij(km){null!=km.g&&(j.clearTimeout(km.g),km.g=null);}k.Ja=function(){return this.R;};function jj(km){this.b=km;this.a=null;}jj.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null);};jj.prototype.create=function(){if(this.a)return h.resolve(this.a);var km=new zh(0,null,this.b);this.a=new ei([km]);return h.resolve(this.a);};function kj(km,lm){tc.call(this,km);this.b=lm;this.g=true;this.h=this.f=null;this.c=new yc();this.a=null;}n(kj,tc);kj.prototype.I=function(){};kj.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.U=this.b=this.f=this.h=this.a=this.c=null;};k=kj.prototype;k.va=function(){return this.f;};k.La=function(){return this.h;};k.zb=function(){return this.c;};k.Na=function(){return true;};k.wa=function(km){km.K.create().then(ed(this,function(lm){if(this.b){if(0==lm.length())return h.reject(Error("No subtitles URL available."));var mm=this.f;this.f=km;this.h=lm;lm=fi(lm).url.b[0].toString();var nm=this.Ia();this.a&&(this.za(false),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=lm;this.za(nm);lm=yb({type:"adaptation",bubbles:true,contentType:"text",size:null,bandwidth:km.bandwidth});this.dispatchEvent(lm);mm||this.c.resolve(0);}}));};k.vb=function(){};k.wb=function(){};k.xb=function(){return true;};k.za=function(km){this.g=km;this.a&&(this.a.track.mode=km?"showing":"disabled");};k.Ia=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g;};function lj(){}lj.prototype.parse=function(km,lm,mm,nm){var om=null;try{var qm,rm=new pb(lm);if(440786851!=rb(rm).id){qm=null;}else{var sm=rb(rm);if(408125543!=sm.id){qm=null;}else{var tm=sm.a.byteOffset,um,vm=new pb(sm.a);for(lm=null;jb(vm.a);){var wm=rb(vm);if(357149030==wm.id){lm=wm;break;}}if(lm){for(var xm=new pb(lm.a),vm=1e+06;jb(xm.a);){var ym=rb(xm);if(2807729==ym.id){vm=ub(ym);break;}}um=vm/1e+09;}else um=null;qm=um?{Xb:tm,bc:um}:null;}}if(qm){var zm=rb(new pb(km));if(475249515!=zm.id){om=null;}else{var an=qm.Xb,bn=qm.bc;km=[];var cn=new pb(zm.a);for(qm=zm=-1;jb(cn.a);){var dn=rb(cn);if(187==dn.id){var en,fn=new pb(dn.a),gn=rb(fn);if(179!=gn.id){en=null;}else{var hn=ub(gn),jn=rb(fn);if(183!=jn.id){en=null;}else{for(var kn=new pb(jn.a),tm=0;jb(kn.a);){var ln=rb(kn);if(241==ln.id){tm=ub(ln);break;}}en={dc:hn,Vb:tm};}}if(en){var mn=bn*en.dc,nn=an+en.Vb;if(0<=zm){var on=new mh(nm,mm,qm,nn-1);km.push(new zh(zm,mn,on));}zm=mn;qm=nn;}}}0<=zm&&(on=new mh(nm,mm,qm,null),km.push(new zh(zm,null,on)));om=km;}}else om=null;}catch(pm){if(!(pm instanceof RangeError))throw pm;}return om;};function mj(km,lm,mm,nm,om,pm,qm,rm){this.g=km;this.i=lm;this.c=mm;this.a=nm;this.f=om;this.b=pm;this.j=qm;this.la=null;this.h=rm;}mj.prototype.destroy=function(){this.h=this.i=this.g=null;this.a.f();this.a=null;this.b&&(this.b.f(),this.b=null);this.f&&(this.f.f(),this.f=null);this.la=null;};mj.prototype.create=function(){if("webm"==this.c){var km=Error("WebM is not supported in this build configuration.");km.type="app";return h.reject(km);}if(this.la)return this.la;km=[ph(this.a)];"webm"==this.c&&km.push(ph(this.f));this.b&&ph(this.b);return this.la=h.all(km).then(ed(this,function(lm){var mm=lm[0];lm=lm[1]||null;var nm=null;"mp4"==this.c?(nm=new di(),nm=nm.parse(new DataView(mm),this.a.h,this.a.b,this.h,this.b)):"webm"==this.c&&(nm=new lj(),nm=nm.parse(new DataView(mm),new DataView(lm),this.a.b,this.h));if(!nm)return mm=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),mm.type="stream",h.reject(mm);var om;"dynamic"==this.g.type?om=new hi(nm,this.g,this.i,this.j):om=new ei(nm);return h.resolve(om);}));};function nj(km){this.a=km;}function oj(km,lm,mm){for(var nm=fb()/1000,om=0;om<lm.a.length;++om)for(var pm=lm.a[om],qm=0;qm<pm.b.length;++qm){var rm=pm.b[qm];if("text"!=rm.contentType)for(var sm=0;sm<rm.a.length;++sm){var tm=rm.a[sm],um=0,um=um+(tm.g?1:0),um=um+(tm.b?1:0),um=um+(tm.a?1:0);0==um?(rm.a.splice(sm,1),--sm):1!=um&&(tm.g?(tm.b=null,tm.a=null):tm.b&&(tm.a=null));}}pj(lm);for(om=0;om<lm.a.length;++om)for(pm=lm.a[om],qm=0;qm<pm.b.length;++qm){sm=rm=pm.b[qm];tm=null;for(um=0;um<sm.a.length;++um){var vm=sm.a[um].f||"";tm?vm!=tm&&(sm.a.splice(um,1),--um):tm=vm;}0==rm.a.length&&(pm.b.splice(qm,1),--qm);}"dynamic"==lm.type&&null==lm.c&&(lm.c=nm);om=new yi();"dynamic"==lm.type&&(om.b=true,om.f=lm.g,om.g=new mh(mm,lm.j||lm.url),om.h=lm.c);om.c=lm.h||5;for(pm=0;pm<lm.a.length;++pm){qm=lm.a[pm];if(null==qm.start)break;qm=qj(km,lm,qm,nm,mm);om.a.push(qm);}return om;}function pj(km){if(km.a.length){null==km.a[0].start&&(km.a[0].start=0);var lm=function(sm){return 0==sm||!!sm;};"dynamic"==km.type&&(km.b=null);lm(km.b)&&1==km.a.length&&!lm(km.a[0].a)&&(km.a[0].a=km.b);for(var mm=0,nm=true,om=0;om<km.a.length;++om){var pm=km.a[om-1],qm=km.a[om],rm=km.a[om+1]||{start:km.b};!lm(qm.start)&&pm&&lm(pm.start)&&lm(pm.a)&&(qm.start=pm.start+pm.a);!lm(qm.a)&&lm(rm.start)&&(qm.a=rm.start-qm.start);null!=qm.start&&null!=qm.a?mm+=qm.a:nm=false;}lm(km.b)||(om=km.a[km.a.length-1],nm?km.b=mm:lm(om.start)&&lm(om.a)?km.b=om.start+om.a:"dynamic"!=km.type&&(km.b=mm));}}function qj(km,lm,mm,nm,om){var pm=new xi();pm.id=mm.id;pm.start=mm.start;pm.b=mm.a;var qm=new lc();mm.b.forEach(function(an){qm.push(an.contentType||"",an);});for(var rm=oc(qm),sm=0;sm<rm.length;++sm){var tm=new lc();qm.get(rm[sm]).forEach(function(an){tm.push(an.group,an);});for(var um=oc(tm),vm=0;vm<um.length;++vm){var wm=new lc();tm.get(um[vm]).forEach(function(an){wm.push(an.lang,an);});for(var xm=oc(wm),ym=0;ym<xm.length;++ym){var zm=wm.get(xm[ym]),zm=rj(km,lm,mm,zm,nm,om);pm.a.push(zm);}}}return pm;}function rj(km,lm,mm,nm,om,pm){o(nm.every(function(ym){return ym.group==nm[0].group&&(ym.lang||"")==(nm[0].lang||"")&&(ym.contentType||"")==(nm[0].contentType||"");}));var qm=new ui(),rm=nm.filter(function(ym){return null!=ym.id;});rm.length==nm.length&&(qm.id=rm.map(function(ym){return ym.id;}).sort().reduce(function(ym,zm){return ym+","+zm;}));qm.lang=nm[0].lang||"";qm.contentType=nm[0].contentType||"";qm.b=nm.some(function(ym){return ym.c;});for(var rm={},sm=0;sm<nm.length;++sm)for(var tm=nm[sm],um=0;um<tm.a.length;++um){var vm=tm.a[um],wm=uj(km,vm),xm=qm.a.slice(0);tj(wm,xm);0==xm.length&&0<qm.a.length||!(vm=wj(lm,mm,vm,om,pm))||(qm.o.push(vm),qm.a=xm,rm[vm.G]=tm);}if(qm.a.some(function(ym){return ""==ym.a;}))return qm.o.forEach(function(ym){ym.S=true;}),qm;km=sj(nm);for(sm=0;sm<qm.o.length;++sm)vm=qm.o[sm],tm=rm[vm.G],tm==km&&(vm.S=true);return qm;}function sj(km){for(var lm=null,mm=null,nm=0;nm<km.length;++nm)for(var om=km[nm],pm=0;pm<om.a.length;++pm){var qm=om.a[pm],qm=(qm.width||1)*(qm.height||1)*(qm.bandwidth||1);if(null==lm||qm<lm)lm=qm,mm=om;}return mm;}function tj(km,lm){if(0==lm.length){Array.prototype.push.apply(lm,km);}else for(var mm=0;mm<lm.length;++mm){for(var nm=false,om=0;om<km.length;++om){var pm=lm[mm],qm=km[om];if(pm.a==qm.a&&pm.h==qm.h&&pm.l==qm.l&&pm.g==qm.g&&pm.i==qm.i&&pm.f==qm.f&&pm.j==qm.j&&xd(pm.c,qm.c)){nm=true;ae(lm[mm],km[om].b);break;}}nm||(lm.splice(mm,1),--mm);}}function uj(km,lm){var mm=[];if(0==lm.c.length){mm.push(new yd());}else if(km.a)for(var nm=0;nm<lm.c.length;++nm)mm.push.apply(mm,vj(km,lm.c[nm]));return mm;}function vj(km,lm){var mm=[];if(2!=km.a.length)return [];var nm=km.a(lm.c||"",lm.f);if(!(nm&&nm instanceof Array))return [];for(var om=0;om<nm.length;++om){var pm,qm=nm[om];pm=new yd();if(qm){var rm=ic(qm,"keySystem");if(null!=rm){pm.a=rm;}else throw Error("'keySystem' cannot be null.");var sm=ic(qm,"licenseServerUrl");if(null!=sm){pm.h=sm;}else if(rm)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");rm=gc(qm,"withCredentials");null!=rm&&(pm.l=rm);rm=kc(qm,"licensePostProcessor",Function);null!=rm&&(pm.m=rm);rm=kc(qm,"licensePreProcessor",Function);null!=rm&&(pm.s=rm);rm=gc(qm,"distinctiveIdentifierRequired");null!=rm&&(pm.g=rm);rm=gc(qm,"persistentStateRequired");null!=rm&&(pm.i=rm);rm=ic(qm,"audioRobustness");null!=rm&&(pm.f=rm);rm=ic(qm,"videoRobustness");null!=rm&&(pm.j=rm);rm=kc(qm,"serverCertificate",Uint8Array);null!=rm&&(pm.c=rm);if(rm=kc(qm,"initData",Object)){qm=kc(rm,"initData",Uint8Array);if(null==qm)throw Error("'initData.initData' cannot be null.");rm=ic(rm,"initDataType");if(null==rm)throw Error("'initData.initDataType' cannot be null.");pm.b.push({initData:new Uint8Array(qm.buffer),initDataType:rm});}}0==pm.b.length&&lm.a&&lm.a.psshBox&&ae(pm,[{initData:lm.a.psshBox,initDataType:"cenc"}]);mm.push(pm);}return mm;}function wj(km,lm,mm,nm,om){if(!mm.u||0===mm.u.length)return null;var pm=null,qm=1,rm=0;if(mm.g){pm=mm.f.split("/")[1];if("mp4"!=pm&&"webm"!=pm){pm=null;}else{var sm=mm.g;"webm"!=pm||sm.c?sm.a||sm.b&&sm.b.a?(qm=sm.b,qm||(qm=new dg(),qm.url=mm.u,qm.a=sm.a?sm.a.clone():null),rm=yj(qm,om),qm=sm.c?yj(sm.c,om):null,sm.f?(sm=sm.f,sm=new mh(om,mm.u,sm.ha,sm.end)):sm=null,km=new mj(km,lm,pm,rm,qm,sm,nm,om),lm=new yh(qm),nm=new ri(),nm.K=km,nm.M=lm,pm=nm):pm=null:pm=null;}qm=mm.g.h;rm=mm.g.g;}else if(mm.b){pm=mm.b,!pm.c&&!pm.f&&1<pm.b.length?pm=null:pm.c||lm.a||pm.f||1!=pm.b.length?pm.f&&0===pm.f.a.length?pm=null:(pm=pm.h?yj(pm.h,om):null,km=new pi(km,lm,mm,nm,om),lm=new yh(pm),nm=new ri(),nm.K=km,nm.M=lm,pm=nm):pm=null,qm=mm.b.a,rm=mm.b.g;}else if(mm.a){km:if(pm=mm.a,qm=0+(pm.f?1:0),qm+=pm.c?1:0,qm+=pm.b?1:0,0==qm?qm=false:(1!=qm&&(pm.f?(pm.c=null,pm.b=null):pm.c&&(pm.b=null)),qm=true),qm){qm=null;if(pm.g&&(qm=(pm=mm.a.g)?xj(mm,pm,eg):null,!qm)){pm=null;break km;}pm=qm?yj(qm,om):null;qm=mm.a;qm.f?(qm=mm.f.split("/")[1],"mp4"!=qm&&"webm"!=qm?km=null:"webm"!=qm||pm?vh(om,mm,1,0)?(rm=(rm=mm.a.f)?xj(mm,rm,dg):null)?(rm=yj(rm,om),km=new mj(km,lm,qm,rm,pm,null,nm,om)):km=null:km=null:km=null):km=qm.h?qm.c?new qi(km,lm,mm,nm,om):qm.b?"dynamic"!=km.type&&null==lm.a?null:new oi(km,lm,mm,nm,om):null:null;km?(lm=new yh(pm),nm=new ri(),nm.K=km,nm.M=lm,pm=nm):pm=null;}else pm=null;;qm=mm.a.a;rm=mm.a.i;}else "text"==mm.f.split("/")[0]&&(pm=new ri(),pm.K=new jj(new mh(om,mm.u)));if(!pm)return null;pm.id=mm.id;rm&&(pm.b=-1*rm/qm);pm.bandwidth=mm.bandwidth;pm.width=mm.width;pm.height=mm.height;pm.a=mm.f||"";pm.c=mm.h||"";pm.fbQualityLabel=mm.fbQualityLabel||null;pm.fbQualityClass=mm.fbQualityClass||null;for(km=0;km<mm.c.length;++km)lm=mm.c[km],lm.b&&pm.f.push(lm.b);return pm;}function xj(km,lm,mm){lm=wh(lm,km.id,null,km.bandwidth,null);if(!lm)return null;mm=new mm();mm.url=oh(km.u,lm);return mm;}function yj(km,lm){var mm=km.url,nm=0,om=null;km.a&&(nm=km.a.ha,om=km.a.end);return new mh(lm,mm,nm,om);}function zj(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[];}function ak(km,lm){var mm=new bk(lm);km.streamHistory.push(new ck(mm));if(mm.videoHeight||!km.streamStats)km.streamStats=mm;}function bk(km){this.videoWidth=km.width;this.videoHeight=km.height;this.videoMimeType=km.a;this.videoBandwidth=km.bandwidth;}function ck(km){this.timestamp=fb()/1000;this.value=km;}function dk(km,lm,mm,nm,om){this.b=new mh(null,[new cf(km)]);this.a=new eh();this.a.body=lm;this.a.method=mm;this.a.a=3;this.a.l=nm;this.a.c=0;km=om||{};for(var pm in km)this.a.b[pm]=km[pm];}function ek(km){return ph(km.b,km.a).then(function(lm){return h.resolve(new Uint8Array(lm));});}function fk(km,lm,mm){tc.call(this,km);this.c=lm;this.j=mm;this.a=this.h=null;this.i=new pc();this.b=[];this.f=[];this.m=0;this.g=new yc();this.l=null;}n(fk,tc);fk.prototype.destroy=function(){this.U=null;for(var km=0;km<this.f.length;++km)this.f[km].close().catch(function(){});this.f=[];this.b=this.a=this.h=null;this.g.destroy();this.g=null;this.i.destroy();this.i=null;this.l&&(j.clearTimeout(this.l),this.l=null);this.c=this.j=null;};fk.prototype.initialize=function(){var km=new lc(),lm;lm=this.j;if(lm.C){lm=lm.a.a[0];for(var mm=[],nm=0;nm<lm.a.length;++nm)mm.push.apply(mm,wi(lm.a[nm]));lm=mm;}else lm=[];for(mm=0;mm<lm.length;++mm)nm=lm[mm],nm.a.a||nm.b&&!nk(nm.b)||km.push(nm.contentType,nm);for(var mm={},nm=false,om=0;om<lm.length;++om){var pm=lm[om];if(pm.a.a&&!km.a.hasOwnProperty(pm.contentType)){var qm=pm.a.a,rm=mm[qm];rm||(rm=pm.a,rm={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:rm.g?"required":"optional",persistentState:rm.i?"required":"optional",sessionTypes:["temporary"]},mm[qm]=rm);if(pm.b&&(qm=pm.contentType+"Capabilities",qm in rm)){nm=true;rm[qm]||(rm[qm]=[]);var sm;"audio"==pm.contentType?sm=pm.a.f:"video"==pm.contentType&&(sm=pm.a.j);rm[qm].push({contentType:pm.b,robustness:sm});}}}if(!nm)if(lm.length){this.a=lm[0].a;}else throw km=Error("No DrmInfo exists!"),km.type="drm",km;if(0==Object.keys(mm).length)return nl(this.j,km),this.g.resolve(),h.resolve();sm=new yc();mm=gk(mm,sm);mm=mm.then(this.v.bind(this,lm,km));sm.reject(null);return mm;};function gk(km,lm){for(var mm in km)lm=lm.catch(function(nm,om){return navigator.requestMediaKeySystemAccess(nm,[om]);}.bind(null,mm,km[mm]));return lm;}fk.prototype.v=function(km,lm,mm){if(!this.c)return ik();for(var nm=mm.keySystem,om=mm.getConfiguration(),pm=["audio","video"],qm=0;qm<pm.length;++qm){var rm=pm[qm];if(!lm.a.hasOwnProperty(rm)){var sm=om[rm+"Capabilities"];if(sm){for(var sm=sm[0],tm=[],um={},vm=0;vm<km.length;++vm){var wm=km[vm],xm=sm?wm.b==sm.contentType:wm.contentType==rm;wm.a.a!=nm||!xm||wm.id in um||(tm.push(wm),um[wm.id]=true,this.a=this.a?zd(this.a,wm.a):wm.a);}lm.set(rm,tm);}}}nl(this.j,lm);return mm.createMediaKeys().then(function(ym){this.h=ym;}.bind(this));};function hk(km){return km.c?km.h?km.c.setMediaKeys(km.h).then(ed(km,function(){return this.c?this.a.c?this.h.setServerCertificate(this.a.c):h.resolve():ik();})).then(ed(km,function(){if(!this.c)return ik();for(var lm=0;lm<this.a.b.length;++lm){var mm=this.a.b[lm];this.s({type:"encrypted",initDataType:mm.initDataType,initData:mm.initData});}0==this.a.b.length&&qc(this.i,this.c,"encrypted",this.s.bind(this));})):h.resolve():ik();}function ik(){var km=Error("EmeManager destroyed");km.type="destroy";return h.reject(km);}fk.prototype.s=function(km){for(var lm=new Uint8Array(km.initData),mm=0;mm<this.b.length;++mm)if(xd(lm,this.b[mm].data))return;try{var om=jk(this);}catch(nm){lm=zb(nm);this.dispatchEvent(lm);this.g.reject(nm);return;}km=om.generateRequest(km.initDataType,km.initData);this.b.push({data:lm,Qa:om});km.catch(ed(this,function(pm){if(this.c){for(var qm=0;qm<this.b.length;++qm)if(this.b[qm].Qa==om){this.b.splice(qm,1);break;}qm=zb(pm);this.dispatchEvent(qm);this.g.reject(pm);}}));this.f.push(om);};function jk(km){var lm=null,lm=km.h.createSession();qc(km.i,lm,"message",km.B.bind(km));qc(km.i,lm,"keystatuseschange",km.A.bind(km));return lm;}fk.prototype.B=function(km){kk(this,km.target,this.a,km.message);};fk.prototype.A=function(km){km=km.target;var lm={};km.keyStatuses.forEach(function(nm,om){if("string"==typeof nm){var pm=nm;nm=om;om=pm;}if("com.microsoft.playready"==this.a.a&&16==nm.byteLength){var pm=new DataView(nm),qm=pm.getUint32(0,true),rm=pm.getUint16(4,true),sm=pm.getUint16(6,true);pm.setUint32(0,qm,false);pm.setUint16(4,rm,false);pm.setUint16(6,sm,false);}pm=wd(new Uint8Array(nm));lm[pm]=om;}.bind(this));if(km.expiration<Date.now()){for(var mm=0;mm<this.b.length;++mm)if(this.b[mm].Qa==km){this.b.splice(mm,1);break;}km.close();this.f.splice(this.f.indexOf(km),1);}ql(this.j,lm);};function kk(km,lm,mm,nm){nm=lk(mm,nm);ek(new dk(nm.url,nm.body,nm.method,mm.l,nm.headers)).then(ed(km,function(om){mm.m&&(om=mm.m(om));return lm.update(om);})).then(ed(km,function(){var om=yb({type:"sessionReady",detail:lm});this.dispatchEvent(om);this.m++;this.m>=this.f.length&&this.g.resolve();})).catch(ed(km,function(om){om.Qa=lm;om=zb(om);this.dispatchEvent(om);}));}function lk(km,lm){var mm={url:km.h,body:lm.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===km.a){for(var nm=String.fromCharCode.apply(null,new Uint16Array(mm.body)),nm=(new DOMParser()).parseFromString(nm,"application/xml"),om=nm.getElementsByTagName("name"),pm=nm.getElementsByTagName("value"),qm=0;qm<om.length;qm++)mm.headers[om[qm].childNodes[0].nodeValue]=pm[qm].childNodes[0].nodeValue;mm.body=j.atob(nm.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue);}if(!km.s)return mm;km.s(mm);mm.url=ic(mm,"url");if(null==mm.url)throw Error("'url' cannot be null.");if(!(mm.body instanceof ArrayBuffer||"string"==typeof mm.body||null==mm.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");mm.method=ic(mm,"method");if("GET"!=mm.method&&"POST"!=mm.method)throw Error("'method' must be either 'GET' or 'POST'.");mm.headers=kc(mm,"headers",Object);if(null==mm.headers)throw Error("'headers' cannot be null.");return mm;}function mk(km){tc.call(this,null);this.a=km;this.b=null;this.f=new pc();this.j=this.i=null;this.B=0;this.v=null;this.l=false;this.I=true;this.F=false;this.H=true;this.g=new zj();this.h=false;this.c={enableAdaptation:true,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new w()};this.m=1;this.C=null;this.s=false;}n(mk,tc);m("shaka.player.Player",mk);mk.version="v1.6.4-fb";mk.isBrowserSupported=function(){return !!j.MediaSource&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement" in document&&!!j.Uint8Array;};mk.prototype.$=function(){var km={},lm=this.b;if(lm){var mm=lm.eb();km.BandwidthEstimator=mm.BandwidthEstimator;var nm=(km.VideoSourceStream=mm.VideoSourceStream).$(),nm=km.VideoBufferManager=nm.SourceBufferManager;km.VideoSourceBuffer=nm.$().SourceBuffer;nm=(km.AudioSourceStream=mm.AudioSourceStream).$();nm=km.AudioBufferManager=nm.SourceBufferManager;km.AudioSourceBuffer=nm.$().SourceBuffer;km.TextSourceStream=mm.TextSourceStream;km.getManifest=lm.ab.bind(lm);}else km.getManifest=function(){};km.hc=true;return km;};mk.prototype.getDebug=mk.prototype.$;mk.prototype.W=function(km){this.I=km;};mk.prototype.setResumeAfterBuffering=mk.prototype.W;function nk(km){return "text/vtt"==km?!!j.VTTCue:MediaSource.isTypeSupported(km);}mk.isTypeSupported=nk;mk.setTextStyle=function(km){var lm=document.getElementById("ShakaPlayerTextStyle");lm||(lm=document.createElement("style"),lm.id="ShakaPlayerTextStyle",document.head.appendChild(lm));for(lm=lm.sheet;lm.cssRules.length;)lm.deleteRule(0);lm.insertRule("::cue { "+y(km)+" }",0);};mk.prototype.destroy=function(){return this.D().then(ed(this,function(){this.f.destroy();this.a=this.f=null;})).catch(function(){});};mk.prototype.destroy=mk.prototype.destroy;mk.prototype.D=function(){this.h=true;return ok(this);};mk.prototype.unload=mk.prototype.D;function ok(km){if(!km.b)return h.resolve();km.l&&uk(km);km.a.pause();rc(km.f);tk(km);rk(km);km.i&&(km.i.destroy(),km.i=null);km.a.src="";var lm=km.a.setMediaKeys(null);km.b&&(km.b.destroy(),km.b=null);km.l=false;km.g=new zj();return lm;}mk.prototype.ra=function(km){return pk(this,km,false);};mk.prototype.load=mk.prototype.ra;mk.prototype.P=function(km){return pk(this,km,true);};mk.prototype.loadWithSilencedErrors=mk.prototype.P;function pk(km,lm,mm){hl(lm,km.a);var nm=null;km.h=false;if(km.b||!km.F)nm=ok(km).then(ed(km,function(){return lm.Aa();}));km.a.autoplay&&(q("load"),qc(km.f,km.a,"timeupdate",km.Eb.bind(km)));lm.mb(km.c);lm.R=km.C;km.C=null;nm||(nm=lm.Aa());nm.catch(ed(km,function(om){lm.destroy();return h.reject(om);}));return nm.then(ed(km,function(){if(!this.a||this.h)return qk();this.b=lm;qc(this.f,this.b,"seekrangechanged",this.Lb.bind(this));this.i=new fk(this,this.a,this.b);return this.i.initialize();})).then(ed(km,function(){if(!this.a||this.h)return qk();qc(this.f,this.a,"error",this.Zb.bind(this));qc(this.f,this.a,"playing",this.Kb.bind(this));qc(this.f,this.a,"pause",this.Jb.bind(this));return il(this.b,this,this.a);})).then(ed(km,function(){return !this.a||this.h?qk():hk(this.i);})).then(ed(km,function(){if(!this.a||this.h)return qk();sk(this);})).catch(ed(km,function(om){if(!this.a||this.h)return qk();if(true!==mm&&"destroy"!=om.type){var pm=zb(om);this.dispatchEvent(pm);}return this.D().then(function(){return h.reject(om);});}));}function qk(){var km=Error("Player destroyed");km.type="destroy";return h.reject(km);}k=mk.prototype;k.Eb=function(){r("load");this.g.playbackLatency=s("load")/1000;this.f.xa(this.a,"timeupdate");};k.Zb=function(){if(this.a.error){var km=this.a.error.code;km!=MediaError.MEDIA_ERR_ABORTED&&(km=Error(vk[km]||"Unknown playback error."),km.type="playback",km=zb(km),this.dispatchEvent(km));}};k.Kb=function(){q("playing");!this.j&&0>this.m&&(this.a.playbackRate=0,this.A(this.a.currentTime,Date.now(),this.m));this.l&&!this.H&&uk(this);};k.Jb=function(){r("playing");var km=s("playing");if(!isNaN(km)){var lm=this.g;lm.playTime+=km/1000;}rk(this);};k.Lb=function(km){this.B=km.start;};k.yb=function(){if(!this.a.paused){r("playing");var km=s("playing");if(!isNaN(km)){var lm=this.g;lm.playTime+=km/1000;q("playing");}}km=this.g;lm=this.a;lm.getVideoPlaybackQuality&&(lm=lm.getVideoPlaybackQuality(),km.decodedFrames=lm.totalVideoFrames,km.droppedFrames=lm.droppedVideoFrames);return this.g;};mk.prototype.getStats=mk.prototype.yb;mk.prototype.qa=function(){return this.b?this.b.F():[];};mk.prototype.getVideoTracks=mk.prototype.qa;mk.prototype.ga=function(){return this.b?this.b.ea():[];};mk.prototype.getAudioTracks=mk.prototype.ga;mk.prototype.pa=function(){return this.b?this.b.nb():[];};mk.prototype.getTextTracks=mk.prototype.pa;mk.prototype.selectVideoTrack=function(km,lm){return this.b?this.b.selectVideoTrack(km,void 0==lm?true:lm):false;};mk.prototype.selectVideoTrack=mk.prototype.selectVideoTrack;mk.prototype.sa=function(km,lm,mm){return this.b?sl(this.b,"audio",km,void 0==lm?true:lm,mm):false;};mk.prototype.selectAudioTrack=mk.prototype.sa;mk.prototype.ta=function(km){return this.b?sl(this.b,"text",km,false):false;};mk.prototype.selectTextTrack=mk.prototype.ta;mk.prototype.fa=function(km){this.b&&ol(this.b,km);};mk.prototype.enableTextTrack=mk.prototype.fa;mk.prototype.V=function(km){rk(this);0<=km?this.a.playbackRate=km:this.a.paused||(this.a.playbackRate=0,this.A(this.a.currentTime,Date.now(),km));this.m=km;};mk.prototype.setPlaybackRate=mk.prototype.V;mk.prototype.O=function(){return this.m;};mk.prototype.getPlaybackRate=mk.prototype.O;mk.prototype.ua=function(km){this.C=km;};mk.prototype.setPlaybackStartTime=mk.prototype.ua;mk.prototype.L=function(){return this.b?this.b.ob():false;};mk.prototype.isLive=mk.prototype.L;mk.prototype.ea=function(km){if(km){var lm=gc(km,"enableAdaptation");null!=lm&&(this.c.enableAdaptation=lm);lm=gc(km,"allowSkipUnloading");null!=lm&&(this.F=lm);lm=gc(km,"endBufferingOnPlaying");null!=lm&&(this.H=lm);lm=gc(km,"usePlaybackRateForBuffering");null!=lm&&(this.s=lm);lm=hc(km,"streamBufferSize",0);null!=lm&&(this.c.streamBufferSize=lm);lm=hc(km,"dynamicStreamBufferSize",0);null!=lm&&(this.c.dynamicStreamBufferSize=lm);lm=gc(km,"addCdnDebugQueryParameters");null!=lm&&(this.c.addCdnDebugQueryParameters=lm);lm=hc(km,"initialStreamBufferSize",0);null!=lm&&(this.c.initialStreamBufferSize=lm);lm=gc(km,"includeStreamBufferSizeInStartOffset");null!=lm&&(this.c.includeStreamBufferSizeInStartOffset=lm);lm=hc(km,"liveStreamEndTimeout",0);null!=lm&&(this.c.liveStreamEndTimeout=lm);lm=hc(km,"licenseRequestTimeout",0);null!=lm&&(this.c.licenseRequestTimeout=lm);lm=hc(km,"mpdRequestTimeout",0);null!=lm&&(this.c.mpdRequestTimeout=lm);lm=hc(km,"minMpdRefreshInterval",0);null!=lm&&(this.c.minMpdRefreshInterval=lm);lm=gc(km,"enableLiveInterruptionDetection");null!=lm&&(this.c.enableLiveInterruptionDetection=lm);lm=gc(km,"enableManifestDebug");null!=lm&&(this.c.enableManifestDebug=lm,tc.prototype.Wa=lm,lm||(tc.prototype.ia=function(){}));lm=gc(km,"resolveVideoTimeUpdateOnFragmentedTimeRanges");null!=lm&&(this.c.resolveVideoTimeUpdateOnFragmentedTimeRanges=lm);lm=hc(km,"liveInterruptionConsecutiveUpdatesWithoutChange");null!=lm&&(this.c.liveInterruptionConsecutiveUpdatesWithoutChange=lm);lm=hc(km,"liveInterruptionConsecutiveUpdatesWithChange");null!=lm&&(this.c.liveInterruptionConsecutiveUpdatesWithChange=lm);lm=gc(km,"reappendInitSegmentAfterAbort");null!=lm&&(this.c.reappendInitSegmentAfterAbort=lm);lm=gc(km,"liveSendPushHeaders");null!=lm&&(this.c.liveSendPushHeaders=lm);lm=hc(km,"liveMaxManifestFetchesWithPush");null!=lm&&(this.c.liveMaxManifestFetchesWithPush=lm);lm=hc(km,"liveMaxSegmentsToPush");null!=lm&&(this.c.liveMaxSegmentsToPush=lm);lm=hc(km,"segmentRequestTimeout",0);null!=lm&&(this.c.segmentRequestTimeout=lm);lm=ic(km,"preferredLanguage");null!=lm&&(this.c.preferredLanguage=lm);lm=kc(km,"restrictions",w);null!=lm&&(this.c.restrictions=lm.clone());km=gc(km,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=km&&(fh=!km);this.b&&this.b.mb(this.c);}};mk.prototype.configure=mk.prototype.ea;mk.prototype.oa=function(){return this.c;};mk.prototype.getConfiguration=mk.prototype.oa;function rk(km){km.j&&(j.clearTimeout(km.j),km.j=null);}function sk(km){tk(km);km.v=j.setTimeout(km.R.bind(km),100);}function tk(km){km.v&&(j.clearTimeout(km.v),km.v=null);}mk.prototype.A=function(km,lm,mm){this.j=null;var nm=(Date.now()-lm)/1000*mm;this.a.currentTime<this.B+(this.L()?1:.05)?this.a.pause():(nm=Math.max(this.B,km+nm),this.a.currentTime=nm,this.j=j.setTimeout(this.A.bind(this,km,lm,mm),250));};function uk(km){r("buffering");var lm=km.g;lm.bufferingTime+=s("buffering")/1000;km.s&&(km.a.playbackRate=km.m);km.l=false;km.dispatchEvent(yb({type:"bufferingEnd"}));}mk.prototype.R=function(){sk(this);if(!this.a.ended&&!this.a.seeking){var km=this.a.buffered,lm=km.length?km.end(km.length-1):0,km=Math.max(lm-this.a.currentTime,0),mm=this.a.currentTime,nm=this.a.duration,nm=isNaN(nm)?0:Math.max(nm-.05,0),lm=lm>=nm||mm>=nm;if(this.l){if(lm=this.b,km>(lm.hb?Number(lm.g.streamBufferSize):Number(lm.g.initialStreamBufferSize))||dm(this.b))uk(this),this.I&&!this.s&&this.a.play();}else !this.a.paused&&!lm&&.5>km&&(this.l=true,this.s?this.a.playbackRate=0:this.a.pause(),this.g.bufferingHistory.push(fb()/1000),q("buffering"),this.dispatchEvent(yb({type:"bufferingStart"}))),dm(this.b)&&uk(this);}};var vk={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function wk(km){for(var lm=0;lm<km.length;++lm)for(var mm=km[lm],nm=0;nm<mm.a.length;++nm){for(var om=mm.a[nm],pm=om,qm=0;qm<pm.o.length;++qm)nk(ti(pm.o[qm]))||(pm.o.splice(qm,1),--qm);0==om.o.length&&(mm.a.splice(nm,1),--nm);}for(lm=0;lm<km.length;++lm)for(mm=km[lm],nm=0;nm<mm.a.length;++nm)mm.a[nm].o.sort(xk);}function xk(km,lm){var mm=km.bandwidth||Number.MAX_VALUE,nm=lm.bandwidth||Number.MAX_VALUE;return mm<nm?-1:mm>nm?1:0;}function yk(km){this.a=km;}yk.prototype.destroy=function(){this.a.destroy();this.a=null;};yk.prototype.update=function(km){var lm=zk(km),mm=zk(this.a);return h.all([lm,mm]).then(ed(this,function(nm){var om=nm[0];nm=nm[1];wk(this.a.a);km.b&&!this.a.b&&(km.i=true);km.f=this.a.f;km.g=this.a.g?this.a.g.clone():null;km.c=this.a.c;var pm=[];al(km,this.a,om,nm,pm);wk(km.a);return h.resolve(pm);}));};function zk(km){function lm(nm,om){return nm.concat(om);}var mm=km.a.map(function(nm){return nm.a;}).reduce(lm,[]).map(function(nm){return nm.o;}).reduce(lm,[]);km=mm.map(function(nm){return nm.K.create();});return h.all(km).then(function(nm){for(var om={},pm=0;pm<mm.length;++pm)om[mm[pm].G]=nm[pm];return h.resolve(om);});}function al(km,lm,mm,nm,om){var pm=new lc();km.a.forEach(function(tm,um){pm.push(tm.id||""+um,tm);});var qm=new lc();lm.a.forEach(function(tm,um){qm.push(tm.id||""+um,tm);});km=oc(pm);for(lm=0;lm<km.length;++lm){var rm=km[lm],sm=pm.get(rm);1<sm.length||(rm=qm.get(rm))&&0!=rm.length&&1==rm.length&&(bl(sm[0],rm[0],mm,nm,om),sm[0].b=rm[0].b);}}function bl(km,lm,mm,nm,om){var pm=new lc();km.a.forEach(function(tm,um){pm.push(tm.id||""+um,tm);});var qm=new lc();lm.a.forEach(function(tm,um){qm.push(tm.id||""+um,tm);});km=oc(pm);for(lm=0;lm<km.length;++lm){var rm=km[lm],sm=pm.get(rm);1<sm.length||(rm=qm.get(rm))&&0!=rm.length&&1==rm.length&&cl(sm[0],rm[0],mm,nm,om);}}function cl(km,lm,mm,nm,om){var pm=new lc();km.o.forEach(function(vm,wm){pm.push(vm.id||""+wm,vm);});var qm=new lc();lm.o.forEach(function(vm,wm){qm.push(vm.id||""+wm,vm);});lm={};for(var rm=oc(pm),sm=0;sm<rm.length;++sm){var tm=rm[sm];lm[tm]=tm;var um=pm.get(tm);1<um.length||((tm=qm.get(tm))&&0!=tm.length?1==tm.length&&(dl(um[0],tm[0],mm,nm),um[0].M=tm[0].M,tm[0].M=null,um[0].b=tm[0].b):(om.push(um[0]),km.o.splice(km.o.indexOf(um[0]),1)));}rm=oc(qm);for(sm=0;sm<rm.length;++sm)tm=rm[sm],lm[tm]||(lm[tm]=tm,tm=qm.get(tm),km.o.push(tm[0]));}function dl(km,lm,mm,nm){km=mm[km.G];nm=nm[lm.G];lm=km.length();km.Oa(nm)&&(nm=km.length(),km.g.push(lm!==nm),50<km.g.length&&km.g.shift());}function el(){this.a=this.b=null;this.f=new pc();this.c=Number.POSITIVE_INFINITY;this.i=true;this.g=false;}m("shaka.media.SimpleAbrManager",el);el.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null;};el.prototype.initialize=function(km,lm){this.b||this.a||(this.b=km,this.a=lm);};el.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4000,qc(this.f,this.b,"bandwidth",this.l.bind(this)),qc(this.f,this.a,"adaptation",this.j.bind(this)),qc(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=true);};el.prototype.enable=function(km){this.i=km;};el.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var km=fl(this);return km?km.id:null;};el.prototype.getInitialSwitchReason=function(){return null;};el.prototype.getInitialAudioTrackId=function(){return null;};el.prototype.selectVideoTrack=function(km,lm,mm){this.g&&this.a.selectVideoTrack(km.id,lm,mm);};el.prototype.l=function(){Date.now()<this.c||this.h();};el.prototype.h=function(){if(this.i){var km=fl(this);if(km){if(km.active){this.c=Date.now()+3000;return;}this.selectVideoTrack(km,false);}this.c=Number.POSITIVE_INFINITY;}};el.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+30000);};function fl(km){var lm=km.a.F();if(0==lm.length)return null;lm.sort(ga);var mm;km:{mm=km.a.ea();for(var nm=0;nm<mm.length;++nm)if(mm[nm].active){mm=mm[nm];break km;}mm=null;};mm=mm?mm.bandwidth:0;km=km.b.getBandwidth();for(var nm=lm[0],om=0;om<lm.length;++om){var pm=lm[om],qm=om+1<lm.length?lm[om+1]:{bandwidth:Number.POSITIVE_INFINITY};if(pm.bandwidth&&(qm=(qm.bandwidth+mm)/.85,km>=(pm.bandwidth+mm)/.95&&km<=qm&&(nm=pm,nm.active)))break;}return nm;}function gl(km,lm,mm){tc.call(this,null);this.a=km;this.P=lm;this.j=new pc();this.h=new MediaSource();this.f=null;this.Da=0;this.gb=false;this.Fa=0;this.ua=3;this.ta=this.hb=false;this.ra=0;this.kb=1;this.sa=Infinity;this.bb=false;this.c=new lc();this.l=mm;this.l.initialize(lm,this);this.C=false;this.B="en";this.ga=false;this.H=null;this.v=new yc();this.ub=new yc();this.i=new w();this.A=null;this.lb=1;this.b={};this.V=new yc();this.qa=0;this.jb=15;this.s=null;this.Va=this.ib=false;this.m={};this.R=this.O=this.I=null;this.g={};this.fa=false;this.tb=null;}n(gl,tc);m("shaka.player.StreamVideoSource",gl);gl.prototype.eb=function(){return {VideoSourceStream:this.b.video,AudioSourceStream:this.b.audio,TextSourceStream:this.b.text,BandwidthEstimator:this.P};};gl.prototype.getStreamDebug=gl.prototype.eb;gl.prototype.mb=function(km){null!=km.streamBufferSize&&(this.g.streamBufferSize=km.streamBufferSize);null!=km.initialStreamBufferSize&&(this.g.initialStreamBufferSize=km.initialStreamBufferSize);null!=km.dynamicStreamBufferSize&&(this.g.dynamicStreamBufferSize=km.dynamicStreamBufferSize);null!=km.addCdnDebugQueryParameters&&(this.g.addCdnDebugQueryParameters=km.addCdnDebugQueryParameters);null!=km.segmentRequestTimeout&&(this.g.segmentRequestTimeout=km.segmentRequestTimeout);null!=km.resolveVideoTimeUpdateOnFragmentedTimeRanges&&(this.g.resolveVideoTimeUpdateOnFragmentedTimeRanges=km.resolveVideoTimeUpdateOnFragmentedTimeRanges);null!=km.reappendInitSegmentAfterAbort&&(this.g.reappendInitSegmentAfterAbort=km.reappendInitSegmentAfterAbort);im(this);null!=km.includeStreamBufferSizeInStartOffset&&(this.gb=Boolean(km.includeStreamBufferSizeInStartOffset));null!=km.enableAdaptation&&this.l.enable(Boolean(km.enableAdaptation));null!=km.mpdRequestTimeout&&(this.Fa=Number(km.mpdRequestTimeout));null!=km.minMpdRefreshInterval&&(this.ua=Number(km.minMpdRefreshInterval)/1000);null!=km.enableManifestDebug&&(this.bb=!!km.enableManifestDebug);null!=km.liveStreamEndTimeout&&(this.jb=Number(km.liveStreamEndTimeout));null!=km.preferredLanguage&&(this.B=dc(String(km.preferredLanguage)));null!=km.liveSendPushHeaders&&(this.ta=Boolean(km.liveSendPushHeaders));null!=km.liveMaxManifestFetchesWithPush&&(this.ra=Number(km.liveMaxManifestFetchesWithPush));null!=km.liveMaxSegmentsToPush&&(this.sa=Number(km.liveMaxSegmentsToPush));null!=km.restrictions&&(this.i=km.restrictions,this.C&&pl(this));};gl.prototype.destroy=function(){this.v.destroy();this.V.destroy();this.V=this.v=null;this.O&&(j.clearTimeout(this.O),this.O=null);this.I&&(j.clearTimeout(this.I),this.I=null);this.m=null;this.j.destroy();this.j=null;fc(this.b).forEach(function(km){km.destroy();});this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null);this.l.destroy();this.U=this.i=this.H=this.f=this.h=this.P=this.l=null;};function hl(km,lm){qc(km.j,km.h,"sourceopen",km.Fb.bind(km));lm.src=j.URL.createObjectURL(km.h);}k=gl.prototype;k.fb=function(){};function il(km,lm,mm){if(!km.C)return km=Error("Cannot call attach() right now."),km.type="app",h.reject(km);km.U=lm;km.f=mm;km.H=lm.yb();qc(km.j,km.P,"bandwidth",km.$b.bind(km));km.a.b&&(qc(km.j,lm,"bufferingStart",km.Db.bind(km)),qc(km.j,lm,"bufferingEnd",km.Cb.bind(km)));lm=km.f.setMediaKeys(km.f.mediaKeys);km.ub.then(ed(km,function(){ul(this).then(ed(this,function(){this.v&&this.v.resolve();this.fb();})).catch(ed(this,function(nm){this.v&&this.v.reject(nm);}));}));return h.all([km.v,lm]);}k.Aa=function(){if(this.C){var km=Error("Cannot call load() right now.");km.type="app";return h.reject(km);}if(!this.a||0==this.a.a.length)return km=Error("The manifest does not specify any content."),km.type="stream",h.reject(km);wk(this.a.a);if(0==this.a.a.length||0==this.a.a[0].a.length||!this.a.a[0].a.some(function(lm){return "video"===lm.contentType;}))return km=Error("The manifest specifies content that cannot be displayed on this browser/platform."),km.type="stream",h.reject(km);this.C=true;this.g.initialStreamBufferSize=Math.max(this.g.initialStreamBufferSize||0,this.a.c);im(this);pl(this);return h.resolve();};function jl(km){var lm=yb({type:"manifestwrapped",bubbles:true});km.dispatchEvent(lm);}k.rb=function(km){var lm=Date.now(),mm=this.I=null,nm,om;if(this.ta&&(!this.ra||this.ra>this.kb)){nm=Math.floor(fm(this))+1;nm=Math.min(nm,this.sa);var pm=this.b.video;if(pm=pm?pm.La():null)pm=pm.w(),null!=pm.a&&(om=pm.a);if(this.f.paused||this.fa)nm=0;}nm&&this.kb++;pm=this.a.g;(km?this.pb():this.qb(pm,nm,om)).then(ed(this,function(qm){mm=new yk(qm);return mm.update(this.a);})).then(ed(this,function(qm){mm.destroy();mm=null;var rm=em(this);this.ia("SegmentIndexesUpdated",rm);rm.some(function(sm){return sm.Ua;})&&jl(this);(rm=gm(this,rm))&&this.f.paused&&rm.end>this.f.currentTime+10&&(this.f.currentTime=rm.end);if(dm(this))return this.ya();for(rm=0;rm<qm.length;++rm)ll(this,qm[rm]);this.g.initialStreamBufferSize=Math.max(this.g.initialStreamBufferSize||0,this.a.c);this.g.useInitialBufferSizeWhenPaused=this.a.b;im(this);pl(this);0==Object.keys(this.b).length?ul(this):kl(this,(Date.now()-lm)/1000);})).catch(ed(this,function(qm){mm&&(mm.destroy(),mm=null);if("delay"==qm.type)return kl(this,0);"aborted"!=qm.type&&(qm=zb(qm),this.dispatchEvent(qm),this.a&&kl(this,0));}));};k.qb=function(){return h.reject("Cannot update manifest with this VideoSource implementation.");};k.pb=function(){return h.reject("Cannot update manifest with this VideoSource implementation.");};function kl(km,lm){if(null!=km.a.f){var mm=Math.max(km.a.f,km.ua),mm=Math.max(mm-lm,0);km.I=j.setTimeout(km.rb.bind(km,false),1000*mm);}}function ll(km,lm){var mm=lm.a.split("/")[0],nm=km.b[mm];if(nm&&nm.va()==lm){var om=km.c.get(lm.a.split("/")[0]).map(function(pm){return pm.o;}).reduce(function(pm,qm){return pm.concat(qm);},[]).filter(function(pm){return pm.S&&pm.J;});if(0==om.length){mm=Error("All usable streams have been removed from the manifest.");mm.type="app";mm=zb(mm);km.dispatchEvent(mm);return;}km.m[mm].Sa==lm&&delete km.m[mm];nm.wa(om[0],true);lm.destroy();}lm.destroy();}k.Yb=function(km){this.tb=km;};gl.prototype.setTaggedTimeRangesEntryAdder=gl.prototype.Yb;gl.prototype.F=function(){if(!this.c||!this.c.a.hasOwnProperty("video"))return [];for(var km=this.b.video,km=(km=km?km.va():null)?km.G:0,lm=[],mm=this.c.get("video"),nm=0;nm<mm.length;++nm)for(var om=mm[nm],pm=0;pm<om.o.length;++pm){var qm=om.o[pm];if(qm.S&&qm.J){var rm=qm.G,qm=new fa(rm,qm.bandwidth,qm.width,qm.height,qm.id,qm.fbQualityLabel,qm.fbQualityClass);rm==km&&(qm.active=true);lm.push(qm);}}return lm;};gl.prototype.getVideoTracks=gl.prototype.F;function ml(km){km=km.F();for(var lm=0;lm<km.length;lm++)if(km[lm].active)return km[lm];}gl.prototype.ea=function(){if(!this.c||!this.c.a.hasOwnProperty("audio"))return [];for(var km=this.b.audio,km=(km=km?km.va():null)?km.G:0,lm=[],mm=this.c.get("audio"),nm=0;nm<mm.length;++nm)for(var om=mm[nm],pm=om.lang,qm=0;qm<om.o.length;++qm){var rm=om.o[qm];if(rm.S&&rm.J){var sm=rm.G,rm=new v(sm,rm.bandwidth,pm,rm.id);sm==km&&(rm.active=true);lm.push(rm);}}return lm;};gl.prototype.getAudioTracks=gl.prototype.ea;gl.prototype.nb=function(){if(!this.c||!this.c.a.hasOwnProperty("text"))return [];for(var km=this.b.text,lm=km?km.va():null,lm=lm?lm.G:0,mm=[],nm=this.c.get("text"),om=0;om<nm.length;++om)for(var pm=nm[om],qm=pm.lang,rm=0;rm<pm.o.length;++rm){var sm=pm.o[rm].G,tm=new ea(sm,qm);sm==lm&&(tm.active=true,tm.enabled=km.Ia());mm.push(tm);}return mm;};gl.prototype.getTextTracks=gl.prototype.nb;function nl(km,lm){if(km.C){for(var mm={},nm=km.a.a[0],om=0;om<nm.a.length;++om){var pm=nm.a[om];mm[pm.G]=pm;}km.c.a={};nm=oc(lm);for(om=0;om<nm.length;++om){var pm=nm[om],qm=lm.get(pm);if("video"==pm){var rm=qm[0].id;km.c.push(pm,mm[rm]);}else if("audio"==pm){for(var rm=qm[0].b.split(";")[0],sm=0;sm<qm.length;++sm){var tm=qm[sm];tm.b.split(";")[0]==rm&&km.c.push(pm,mm[tm.id]);}}else for(sm=0;sm<qm.length;++sm)rm=qm[sm].id,km.c.push(pm,mm[rm]);}km.ga=true;if(mm=km.c.get("audio"))tl(km,mm),km.c.set("audio",mm),mm=mm[0].lang||km.B,ac(2,km.B,mm)&&(km.ga=false);if(mm=km.c.get("text"))tl(km,mm),km.c.set("text",mm),mm=mm[0].lang||km.B,ac(2,km.B,mm)||(km.ga=false);}}gl.prototype.selectVideoTrack=function(km,lm,mm,nm){return sl(this,"video",km,lm,mm,nm);};function ol(km,lm){var mm=km.b.text;mm&&mm.za(lm);}function pl(km){if(km.i){for(var lm=false,mm=0;mm<km.a.a.length;++mm)for(var nm=km.a.a[mm],om=0;om<nm.a.length;++om){var pm=nm.a[om];if("video"==pm.contentType)for(var qm=0;qm<pm.o.length;++qm){var rm=pm.o[qm],sm=rm.J;rm.J=true;km.i.maxWidth&&rm.width>km.i.maxWidth&&(rm.J=false);km.i.maxHeight&&rm.height>km.i.maxHeight&&(rm.J=false);km.i.minHeight&&rm.height<km.i.minHeight&&(rm.J=false);km.i.maxBandwidth&&rm.bandwidth>km.i.maxBandwidth&&(rm.J=false);km.i.minBandwidth&&rm.bandwidth<km.i.minBandwidth&&(rm.J=false);sm!=rm.J&&(lm=true);}}0!=mc(km.c).length&&lm&&(rl(km),0<km.F().length||(lm=Error("The application has restricted all video tracks!"),lm.type="app",lm=zb(lm),km.dispatchEvent(lm)));}}gl.prototype.ob=function(){return this.a?this.a.b:false;};gl.prototype.isLive=gl.prototype.ob;gl.prototype.Wb=function(km){this.hb=km;};gl.prototype.setIsLiveInterrupted=gl.prototype.Wb;gl.prototype.ec=function(){for(var km in this.b)this.b[km].wb();};gl.prototype.forceResyncVideoBuffer=gl.prototype.ec;function ql(km,lm){for(var mm,nm=false,om=new lc(),pm=mc(km.c),qm=0;qm<pm.length;++qm)for(var rm=pm[qm],sm=0;sm<rm.o.length;++sm){var tm=rm.o[sm];tm.f.forEach(function(um){om.push(um,tm);});}for(mm in lm)if(pm=vb[lm[mm]]||null,rm=om.get(mm)){for(qm=0;qm<rm.length;++qm)tm=rm[qm],sm=tm.S,tm.S=!pm,sm!=tm.S&&(nm=true);}else zc(mm);nm&&(rl(km),nm=km.ea(),mm=km.F(),nm=km.c.a.hasOwnProperty("audio")&&0==nm.length,mm=km.c.a.hasOwnProperty("video")&&0==mm.length,nm||mm)&&(mm=Error("The key system has restricted all "+(nm&&mm?"audio and video tracks.":nm?"audio tracks.":"video tracks.")),mm.type="drm",mm=zb(mm),km.dispatchEvent(mm));}function rl(km){var lm=yb({type:"trackschanged",bubbles:true});km.dispatchEvent(lm);}function sl(km,lm,mm,nm,om,pm){if(!km.c.a.hasOwnProperty(lm)||!km.b[lm])return false;for(var qm=km.c.get(lm),rm=0;rm<qm.length;++rm)for(var sm=qm[rm],tm=0;tm<sm.o.length;++tm){var um=sm.o[tm];if(um.G==mm){if(!um.S||!um.J)return false;if("text"!=lm&&!km.Va)return mm=km.m[lm],km.m[lm]={Sa:um,Za:null!=mm&&mm.Za||nm,$a:null!=mm&&mm.$a||om,switchReason:pm},true;ak(km.H,um);km.b[lm].wa(um,nm,om,pm);return true;}}return false;}function tl(km,lm){for(var mm=0;2>=mm;++mm)for(var nm=0;nm<lm.length;++nm){var om=lm[nm];if(ac(mm,km.B,om.lang)){lm.splice(nm,1);lm.splice(0,0,om);return;}}for(nm=0;nm<lm.length;++nm)if(om=lm[nm],om.b){lm.splice(nm,1);lm.splice(0,0,om);break;}}k=gl.prototype;k.Fb=function(){this.j.xa(this.h,"sourceopen");this.ub.resolve();};function ul(km){for(var lm=[],mm=["audio","video","text"],nm=0;nm<mm.length;++nm){var om=mm[nm];km.c.a.hasOwnProperty(om)&&lm.push(km.c.get(om)[0]);}for(var pm=vl(km,lm),nm=0;nm<mm.length;++nm)if(om=mm[nm],km.c.a.hasOwnProperty(om)&&!pm[om])return km=Error("Unable to select an initial "+om+" stream: all "+om+" streams have been restricted (by the application or by the key system)."),km.type="stream",h.reject(km);lm=fc(pm).map(function(qm){return qm.K.create();});return h.all(lm).then(ed(km,function(qm){if(!qm.every(function(rm){return rm.length();}))return qm=Error("Some streams are not available."),qm.type="stream",h.reject(qm);qm=gm(this,qm);if(!qm)return qm=Error("Some streams are not available."),qm.type="stream",h.reject(qm);if(!wl(this,pm))return qm=Error("Failed to create Stream objects."),qm.type="stream",h.reject(qm);this.l.start();yl(this,pm,qm);return h.resolve();})).catch(ed(km,function(qm){if("aborted"!=qm.type)return Object.keys(this.b),this.a.b?(fb()<this.a.h?(qm=Math.max(this.a.h-Date.now()/1000,this.ua),this.I=j.setTimeout(this.rb.bind(this,true),1000*qm)):kl(this,0),h.resolve()):h.reject(qm);}));}function vl(km,lm){for(var mm={},nm=0;nm<lm.length;++nm){var om=lm[nm],pm=null;if("video"==om.contentType){var qm=km.l.getInitialVideoTrackId();if(null==qm)continue;pm=om.o.filter(function(rm){return rm.G==qm;});if(0==pm.length)continue;pm=pm[0];}else if("audio"==om.contentType){if(qm=km.l.getInitialAudioTrackId(),pm=om.o.filter(function(rm){return rm.G==qm;}),0==pm.length){pm=om.o.filter(function(rm){return rm.S&&rm.J;});if(0==pm.length)continue;pm=om.o[Math.floor(pm.length/2)];}else pm=pm[0];}else 0<om.o.length&&(pm=om.o[0]);mm[om.contentType]=pm;}return mm;}function wl(km,lm){var mm={},nm;for(nm in lm){var om=lm[nm],om="text"==nm?new kj(km,km.f):xl(km,om);if(!om)return fc(mm).forEach(function(pm){pm.destroy();}),false;mm[nm]=om;}km.b=mm;return true;}function xl(km,lm){var mm=new aj(km,km.f,km.h,ti(lm),km.P,km.tb);mm.I(km.g);return mm;}function yl(km,lm,mm){km.lb=km.f.playbackRate;km.f.playbackRate=0;am(km,mm);var nm;km.R&&km.R<=mm.end&&km.R>=mm.start?nm=km.R:km.a.b?(nm=mm.end,km.ib=true):nm=mm.start;qc(km.j,km.f,"seeking",km.Mb.bind(km));km.f.currentTime!=nm&&(km.f.currentTime=nm,km.A=nm);bm(km,mm.start,mm.end);var om=[],pm;for(pm in km.b){mm=km.b[pm];ed(km,function(rm){om.push(rm.zb(this.V).then(ed(this,function(sm){var tm=rm.Ja();tm>this.Da&&(this.Da=tm);return sm;})));})(mm);qc(km.j,mm,"ended",km.Nb.bind(km));nm=lm[pm];ak(km.H,nm);var qm=km.l.getInitialSwitchReason()||void 0;mm.wa(nm,false,void 0,qm);}h.all(om).then(km.Bb.bind(km)).catch(ed(km,function(rm){"destroy"!=rm.type&&(rm=zb(rm),this.dispatchEvent(rm));}));ol(km,km.ga);}k.Bb=function(km){o(km&&km.length==Object.keys(this.b).length);for(var lm=Number.POSITIVE_INFINITY,mm=Number.NEGATIVE_INFINITY,nm=0;nm<km.length;++nm)var om=km[nm],lm=Math.min(lm,om),mm=Math.max(mm,om);km=em(this);for(nm=0;nm<km.length;++nm)km[nm].ma(mm);zl(this,km,mm);nm=mc(this.c).map(function(pm){return pm.o;}).reduce(function(pm,qm){return pm.concat(qm);},[]).map(function(pm){var qm=[pm.K.create()];pm.M&&qm.push(pm.M.create());return h.all(qm);});h.all(nm).then(ed(this,function(pm){for(var qm=0;qm<pm.length;++qm)pm[qm][0].ma(mm);this.Va=true;for(var rm in this.m)pm=this.m[rm],qm=this.b[rm],ak(this.H,pm.Sa),qm.wa(pm.Sa,pm.Za,pm.$a,pm.switchReason);this.m={};})).catch(ed(this,function(pm){"aborted"!=pm.type&&(pm=zb(pm),this.dispatchEvent(pm));}));};function zl(km,lm,mm){if(lm=gm(km,lm))am(km,lm),bm(km,lm.start,lm.end);0!=mm?(mm=km.f.currentTime+mm,km.f.currentTime=mm,km.A=mm):km.ib&&lm&&(km.f.currentTime=lm.end);km.f.playbackRate=km.lb;km.a.b&&null!=km.a.f&&kl(km,0);hm(km);km.V.resolve();}function am(km,lm){if(km.a.b){isNaN(km.h.duration)&&(km.h.duration=lm.end+2592000);}else if(isNaN(km.h.duration)||lm.end>km.h.duration){km.h.duration=lm.end;for(var mm=0;mm<km.h.sourceBuffers.length;++mm)km.h.sourceBuffers[mm].appendWindowEnd=lm.end;}}k.Ob=function(){this.O=null;hm(this);var km=gm(this,em(this));km&&(this.a.b&&this.qa!=km.w&&(this.qa=km.w,null!=this.s&&(j.clearTimeout(this.s),this.s=null)),bm(this,km.start,km.end),this.f.paused||cm(this,this.f.currentTime,km.start,km.end));};function bm(km,lm,mm){lm=yb({type:"seekrangechanged",bubbles:true,start:lm,end:mm});km.dispatchEvent(lm);}k.Mb=function(){var km=this.f.currentTime;if(null!=this.A){if(km>=this.A-.01&&km<=this.A+.01){this.A=null;return;}this.A=null;}var lm=gm(this,em(this));if(lm){var mm=lm.end;(lm=cm(this,km,lm.start,mm))||(km<=mm+.01?lm=false:(this.f.currentTime=mm,lm=true));if(!lm)for(var nm in this.b)this.b[nm].vb();}};function cm(km,lm,mm,nm){if(lm>=mm-.01)return false;lm=0;if(km.a.b){lm=.5;for(var om in km.b)if(!km.b[om].xb(mm+lm)){lm=km.a.c;break;}}km.f.currentTime=Math.min(mm+lm,nm);return true;}k.Nb=function(){if(!this.a.b){for(var km in this.b)if(!this.b[km].Na())return;this.ya();}};function dm(km){return km.a.i&&km.f.currentTime+.5>km.qa?true:false;}k.Db=function(){this.fa=true;if(dm(this))return this.ya();fc(this.b).every(function(km){return km.Na();})&&(this.s=j.setTimeout(this.ya.bind(this),1000*this.jb));};k.Cb=function(){this.fa=false;null!=this.s&&(j.clearTimeout(this.s),this.s=null);};k.$b=function(){var km=this.H,lm=this.P.getBandwidth();km.estimatedBandwidth=lm;km.bandwidthHistory.push(new ck(lm));};k.ya=function(){this.fa=false;this.s=null;this.h.endOfStream();};function em(km){return fc(km.b).map(function(lm){return lm.La();}).filter(function(lm){return null!=lm;});}function fm(km){return Math.max(km.a?km.a.c:1,km.gb?km.g.streamBufferSize||0:0);}function gm(km,lm){for(var mm=0,nm=Number.POSITIVE_INFINITY,om=Number.POSITIVE_INFINITY,pm=0;pm<lm.length;++pm){var qm=lm[pm].Ka(),mm=Math.max(mm,qm.start);null!=qm.end&&(nm=Math.min(nm,qm.end));lm[pm].length()&&(om=Math.min(om,lm[pm].w().endTime));}if(nm==Number.POSITIVE_INFINITY)if(nm=km.a.a[0],nm.b){nm=(nm.start||0)+nm.b;}else return null;km.a.b&&(pm=fm(km),nm=Math.max(nm-pm,mm));if(mm>nm)return null;nm=Math.floor(100000*nm)/100000;return {start:mm,end:nm,w:om};}function hm(km){km.a.b&&(km.O=j.setTimeout(km.Ob.bind(km),1000));}function im(km){for(var lm in km.b)km.b[lm].I(km.g);}k.Ja=function(){return this.Da;};gl.prototype.getLongestInitResponseTime=gl.prototype.Ja;function jm(km,lm,mm,nm){mm||(mm=new vc());nm||(nm=new el());gl.call(this,null,mm,nm);"string"===typeof km?this.Ub=km:this.Ga=km;this.L=null;this.W=lm;this.oa=[];this.Xa=[];this.Ya=[];this.pa=0;this.D=null;}n(jm,gl);m("shaka.player.DashVideoSource",jm);jm.prototype.ab=function(){return this.Ga||this.L;};jm.prototype.debugGetManifest=jm.prototype.ab;jm.prototype.ac=function(km,lm,mm){this.oa.push(km);this.Xa.push(lm||"");this.Ya.push(mm||"");};jm.prototype.addExternalCaptions=jm.prototype.ac;jm.prototype.cc=function(km){this.D=km;};jm.prototype.setNetworkCallback=jm.prototype.cc;jm.prototype.destroy=function(){this.L=this.D=this.W=null;gl.prototype.destroy.call(this);};jm.prototype.Aa=function(){var km,lm=ed(this,function(pm){this.ia("MPDFetchDuration",(Date.now()-km)/1000);this.L=pm;for(var qm=0;qm<this.oa.length;qm++){var rm=pm,sm=this.oa[qm],tm=this.Xa[qm],um=this.Ya[qm];if(0!==rm.a.length){var vm=new uf();vm.contentType="text";vm.lang=tm||"en";vm.c=true;tm=new xf();tm.bandwidth=0;tm.f=um||"text/vtt";tm.u=[new cf(sm)];vm.a.push(tm);rm.a[0].b.push(vm);lg(rm.a[0]);}}this.a=oj(new nj(this.W),pm,this.D);return gl.prototype.Aa.call(this);});if(this.Ga)return km=Date.now(),lm(this.Ga);var mm=[new cf(this.Ub)],nm;if(this.ta){nm=Math.floor(fm(this))+1;var om=ml(this);nm=Math.min(nm,this.sa);nm=new th(nm);nm.b=Math.floor(fm(this)+1);null!=om&&(nm.a=om.streamInfoID);}mm=new mh(this.D,mm);mm=new rh(mm,this.Fa,nm);km=Date.now();return sh(mm).then(lm);};jm.prototype.fb=function(){if(this.bb){var km=this.a;if(km=(km=km&&km.a)&&km[0])km=km.a.reduce(function(lm,mm){return lm.concat(mm.o);},[]),h.all(km.map(function(lm){return lm.K.la;})).then(function(lm){lm=lm.filter(function(mm){return null!=mm;});this.ia("InitialSegmentIndexes",lm);}.bind(this));}};jm.prototype.qb=function(km,lm,mm){if(this.f.paused&&this.pa+10000>Date.now()&&this.a)return h.reject({type:"delay"});var nm;lm&&void 0!=mm&&(nm=new th(lm),nm.c=mm,lm=ml(this),null!=lm&&(nm.a=lm.streamInfoID));km=new rh(km,this.Fa,nm);var om=Date.now();return sh(km).then(ed(this,function(pm){this.pa=Date.now();this.ia("MPDFetchDuration",(this.pa-om)/1000);this.L=pm;pm=oj(new nj(this.W),pm,this.D);return h.resolve(pm);}));};jm.prototype.pb=function(){var km=oj(new nj(this.W),this.L,this.D);return h.resolve(km);};}.bind(i,b))();f.exports=i.shaka;}),null);